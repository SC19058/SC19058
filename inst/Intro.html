<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19058" />

<meta name="date" content="2019-12-27" />

<title>Introduction to DISCO</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to DISCO</h1>
<h4 class="author">19058</h4>
<h4 class="date">2019-12-27</h4>



<div id="packages-introduction" class="section level1">
<h1>packages introduction</h1>
<div id="theory" class="section level2">
<h2>Theory</h2>
<p>Consider the null hypothesis for K samples <span class="math inline">\(H_0:F_1=...=F_K\)</span> , For two sample <span class="math inline">\(A=\left\{a_{1}, \dots, a_{n_{1}}\right\}\)</span> and <span class="math inline">\(B=\left\{b_{1}, \dots, b_{n_{2}}\right\}\)</span>, we define <span class="math inline">\(\alpha-distance\)</span> between A and B is defined as: <span class="math display">\[
d_{\alpha}(A, B)=\frac{n_{1} n_{2}}{n_{1}+n_{2}}\left[2 g_{\alpha}(A, B)-g_{\alpha}(A, A)-g_{\alpha}(B, B)\right]
\]</span> where <span class="math inline">\(g_{\alpha}(A, B)=\frac{1}{n_{1} n_{2}} \sum_{i=1}^{n_{1}} \sum_{m=1}^{n_{2}}\left\|a_{i}-{b}_{m}\right\|^{\alpha}\)</span>, <span class="math inline">\(\alpha\)</span> is the index.</p>
<p>We define <strong>total dispersion</strong> by <span class="math inline">\(T_{\alpha}=T_{\alpha}\left(A_{1}, \ldots, A_{K}\right)=\frac{N}{2} g_{\alpha}(A, A)\)</span></p>
<p><strong>between sample dispersion</strong> is <span class="math inline">\(S_{\alpha}=S_{\alpha}\left(A_{1}, A_{2}, \ldots, A_{K}\right)=\sum_{1 \leq j&lt;k \leq K}\left(\frac{n_{j}+n_{k}}{2 N}\right) d_{\alpha}\left(A_{j}, A_{k}\right)\)</span></p>
<p><strong>within sample dispersion</strong> is <span class="math inline">\(W_{\alpha}=W_{\alpha}\left(A_{1}, \ldots, A_{K}\right)=\sum_{j=1}^{K} \frac{n_{j}}{2} g_{\alpha}\left(A_{j}, A_{j}\right)\)</span></p>
<p>Now we have the decompsition <span class="math inline">\(T_{\alpha}\left(A_{1}, \ldots, A_{K}\right)=S_{\alpha}\left(A_{1}, \ldots, A_{K}\right)+W_{\alpha}\left(A_{1}, \ldots, A_{K}\right)\)</span></p>
<p>Let <span class="math inline">\(\xi=E\left\|X_{j}-X_{i}^{\prime}\right\|^{\alpha}\)</span>, from deduction we know:<span class="math display">\[\begin{aligned} E\left[S_{\alpha}\right] &amp;=\frac{1}{2 N} \sum_{1 \leq j&lt;k \leq K} n_{j} n_{k}\left(2 \xi-\frac{n_{j}-1}{n_{j}} \xi-\frac{n_{k}-1}{n_{k}} \xi\right) \\ &amp;=\frac{\xi}{2 N} \sum_{1 \leq j&lt;k \leq K} n_{j} n_{k}\left(\frac{1}{n_{j}}+\frac{1}{n_{k}}\right)=\frac{K-1}{2} \xi \\ E\left[W_{\alpha}\right] &amp;=\sum_{j=1}^{K} \frac{n_{j}}{2}\left(\frac{n_{j}-1}{n_{j}}\right) \xi=\frac{N-K}{2} \xi \end{aligned}\]</span></p>
<p>Now <strong>proposed statistics</strong> for testing equality of distribution is:<span class="math display">\[D_{n, \alpha}=F_{\alpha}=\frac{S_{\alpha} /(K-1)}{W_{\alpha} /(N-K)}\]</span></p>
<p>Obviously the large values support the alternative hypothesis. We can implement a permutation test to get the p value. We call this method <strong>DISCO</strong> (distance components)</p>
</div>
<div id="function" class="section level2">
<h2>Function</h2>
<p>This fucntion <code>d_stat</code> calculate the statistics to test multrivariate test for equal distributions based on energy method:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">d_stat &lt;-<span class="st"> </span><span class="cf">function</span>(size,group,index,distance){</a>
<a class="sourceLine" id="cb1-2" title="2">  total &lt;-<span class="st"> </span>size <span class="op">*</span><span class="st"> </span>group</a>
<a class="sourceLine" id="cb1-3" title="3">  ind &lt;-<span class="st"> </span>index;ind &lt;-<span class="st"> </span><span class="kw">matrix</span>(ind,<span class="dt">byrow =</span> <span class="ot">TRUE</span>,<span class="dt">nrow =</span> group)</a>
<a class="sourceLine" id="cb1-4" title="4">  add.w &lt;-<span class="st"> </span><span class="kw">numeric</span>(group)</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>group) {</a>
<a class="sourceLine" id="cb1-6" title="6">    add.w[i] &lt;-<span class="st"> </span>size<span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(distance[ind[i,],ind[i,]])</a>
<a class="sourceLine" id="cb1-7" title="7">  }</a>
<a class="sourceLine" id="cb1-8" title="8">  w &lt;-<span class="st"> </span><span class="kw">sum</span>(add.w)</a>
<a class="sourceLine" id="cb1-9" title="9">  s &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(group<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>group){</a>
<a class="sourceLine" id="cb1-12" title="12">      s =<span class="st"> </span>s <span class="op">+</span><span class="st"> </span>size<span class="op">^</span><span class="dv">2</span><span class="op">/</span>total <span class="op">*</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="st">        </span>( <span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(distance[ind[i,],ind[j,]]) <span class="op">-</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="st">            </span><span class="kw">mean</span>(distance[ind[j,],ind[j,]]) <span class="op">-</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">            </span><span class="kw">mean</span>(distance[ind[i,],ind[i,]]) )</a>
<a class="sourceLine" id="cb1-16" title="16">    }</a>
<a class="sourceLine" id="cb1-17" title="17">  }</a>
<a class="sourceLine" id="cb1-18" title="18">  s<span class="op">/</span>(group <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(w<span class="op">/</span>(total <span class="op">-</span><span class="st"> </span>group))</a>
<a class="sourceLine" id="cb1-19" title="19">}</a></code></pre></div>
<p>This function <code>equal_test</code> implement a permuation test, using energy method to calculate p value for multivariate test for equal distribution in the balanced design:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">equal_test &lt;-<span class="st"> </span><span class="cf">function</span>(dat,size,group,dim,<span class="dt">R =</span> <span class="dv">199</span>){</a>
<a class="sourceLine" id="cb2-2" title="2">  total.size &lt;-<span class="st"> </span>size<span class="op">*</span>group</a>
<a class="sourceLine" id="cb2-3" title="3">  distance &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(dat,<span class="dt">diag =</span> <span class="ot">TRUE</span>,<span class="dt">upper =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                             <span class="dt">method =</span> <span class="st">&quot;minkowski&quot;</span>,<span class="dt">p =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-5" title="5">  d_stat_storage &lt;-<span class="st"> </span><span class="kw">numeric</span>(R<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">  index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(size<span class="op">*</span>group)</a>
<a class="sourceLine" id="cb2-7" title="7">  d_stat_storage[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">d_stat</span>(size,group,index,distance)</a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</a>
<a class="sourceLine" id="cb2-9" title="9">    index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>total.size,total.size,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-10" title="10">    d_stat_storage[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">d_stat</span>(size,group,index,distance)</a>
<a class="sourceLine" id="cb2-11" title="11">  }</a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="kw">mean</span>(d_stat_storage <span class="op">&gt;</span><span class="st"> </span>d_stat_storage[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb2-13" title="13">}</a></code></pre></div>
<p>Here is an example</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(SC19058)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;SC19058&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     equal_test</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">pdim &lt;-<span class="st"> </span><span class="dv">10</span>;delta &lt;-<span class="st"> </span><span class="fl">0.3</span>;size =<span class="st"> </span><span class="dv">30</span>;group =<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb6-2" title="2">dat &lt;-<span class="st"> </span><span class="kw">c</span>(dat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rt</span>(<span class="dt">n =</span> size<span class="op">*</span>pdim,<span class="dt">df =</span> <span class="dv">4</span>,<span class="dt">ncp =</span> delta),</a>
<a class="sourceLine" id="cb6-3" title="3">                  <span class="kw">rt</span>(<span class="dt">n =</span> size<span class="op">*</span>pdim<span class="op">*</span>(group <span class="op">-</span><span class="st"> </span><span class="dv">1</span>),<span class="dt">df =</span> <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb6-4" title="4">dat &lt;-<span class="st"> </span><span class="kw">matrix</span>(dat,<span class="dt">byrow =</span> <span class="ot">TRUE</span>,<span class="dt">nrow =</span> size<span class="op">*</span>group)</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw">equal_test</span>(dat,size,group,dim)</a></code></pre></div>
<pre><code>## [1] 0.155</code></pre>
</div>
<div id="simulation" class="section level2">
<h2>Simulation</h2>
<p>For comparison, we choose the <strong>Pillai statistics</strong> and the <strong>Wilks statistics</strong>, which is used to test if the mean vector is identical with normal assumption of error in MANOVA. In this part, we use function <code>manova</code>.</p>
<p>In the two examples below, we present the results of Monte Carlo studies<strong>(2000 times)</strong> to assess empirical power of DISCO tests, in our simulations, the permutation times <strong>R=199</strong> replications are generated for each DISCO test decision. We make <strong>index=1</strong>, which reduces the computational complexity, and the <strong>significance level 0.1</strong></p>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>In this case, we choose student t(4) distributions which are close to normal distribution, and add a location difference. The multivariate response is generated in a four-group balanced design with common sample size n = 30, the marginal distributions are independent with student t(4) distributions . Sample 1 is noncentral t(4) with parameter <span class="math inline">\(\delta\)</span>, while others are central.</p>
<ul>
<li>Firstly, the dimension of data is fixed at 10, <span class="math inline">\(\delta\)</span> varies from 0 to 0.6:</li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If only the location is different, these three methods have quite similar empirical powers.</p>
<ul>
<li>Then, <span class="math inline">\(\delta\)</span> is fixed at 0.2, dimension varies from 10 to 100:</li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the dimension increases, DISCO has better performance than MANOVA.</p>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p>In this case, we choose chi-squared distributions, and multiple a lognormal error. Again, a four-group balanced design with common sample size n = 30, the marginal distributions are independent with gamma(shape = 2, rate = 0.1). Sample 1 has a multiplicative errors distributed as Lognormal(<span class="math inline">\(\mu=0,\sigma\)</span>)</p>
<ul>
<li>Firstly, dimension is fixed at 10, <span class="math inline">\(\sigma\)</span> varies from 0 to 1.2</li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From this figure, we can see that DISCO have slighly better performance than MANOVA in low dimension case.</p>
<ul>
<li>Secondly, <span class="math inline">\(\sigma\)</span> is fixed at 0.5, dimension varies from 10 to 110.</li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In high dimension case, the advantage of DISCO is stronger.</p>
</div>
</div>
<div id="advantage-of-disco-test" class="section level2">
<h2>Advantage of DISCO test</h2>
<ul>
<li>DISCO is analogous to the classical decomposition of variance, but <strong>generalizes the decomposition</strong> to a family of methods indexed by an exponent in (0, 2].</li>
<li>DISCO test can be applied <strong>in arbitrary dimension</strong>, not constrained by number of observations.</li>
<li>DISCO test <strong>doesn’t require the usual assumption of homogeneity of error variance</strong>.</li>
<li>Permutation test implementation is <strong>nonparametric</strong> and <strong>does not depend on distributions of the sampled populations</strong>.</li>
</ul>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Rizzo, M. L. Statistical computing with R</li>
<li>Gabor J.Szekely, Maria L. Rizzo Energy Statistics: A Class of Statistics Based on Distances</li>
<li>Maria L. Rizzo, Gabor J.Szekely DISCOR Analysis: A Nonpara -metric Extension of Analysis of Variance</li>
</ul>
</div>
</div>
<div id="homework" class="section level1">
<h1>Homework</h1>
<div id="hw12019-9-20" class="section level2">
<h2>HW1:2019-9-20</h2>
<ul>
<li><p>Go through “R for Beginners” if you are not familiar with R programming.</p></li>
<li><p>Use knitr to produce at least 3 examples (texts, figures, tables).</p></li>
</ul>
<div id="text" class="section level3">
<h3>TEXT</h3>
<p>This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents.</p>
<p>When you click the <strong>Knit</strong> button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.</p>
</div>
<div id="figures" class="section level3">
<h3>FIGURES</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">set.seed</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">hist</span>(x)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////GLYcbAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIoElEQVR4nO2da2ObNhSGSRcvXrpL0nRb7W7rFrItG71ss5OY///HhiSwiW30SpZAp/A+HxLHEcfisZAOICAriZUsdQWkQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQF6F7RZZrOV+X2x/aP179//jv2Bd/Ms+zZauMSCHm9exBa0ziquooUbVtABeRZdUJGd3UYMl6QFvb/MsrNv7pWfCqXo4+ss++IH3bg2d1l2fqvNVev67iZ7cV9+vKnKvazW++k6u/h4mZ29Kd/Pq1K7j9kG0CGNooe5ClJ9ZsiXkEJQkWW1mEZQ/Y4qWBVRa3i5e3u2Wpt/V6tdCTJcNmoNuwAtQerdK/VjEVD/IQQ11IJUK1iVH3RHYTax6qs23q50F3Kx2uSNt9l9+U+11JcrVehKC7pSy2Zv6vKadoDWJlYtePZuvj8u+JFAULU253/W/zWC6p4oN41Kva5EGEGLuuCnPy5VgOr9anXNT22sHaZstsvtplcVyQK7pASCzDumx8nrXkJ/yWrVmtfP1nXzUxNAtb6y/rkT1A7wvJPOg0e0FH3Q443pUn6rPZj11VvXonndFqSMnv/y6bpTUDvAc0HreeiYliYPevz5sulSHVqQMfHULaizBenGGtQFpUsUN293PU53H6TXVTeMbSd9RFBnH1To4S5oG0sgqFrf7/R2pgcetTbdo1jTgmarx2V3H9Q1iqm3/70O28hStKC7bVqj9wtsedC2D7J20u08qCVIjfK32nhA/ZNsYh9UD/TyvqzT5vs6Ef7RLFC99fX9wSh2/mtRvdUlqBVgJ2httq48KFOUergjD+xboyFOUK6PVVStI2S7iIg4QfV+V9xd8gDECSofX8/rfX0RyBMkDAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwE9Qc+gq+vliuXgJKpojVOuIswOE4yNos9wd4hRyOKt/fAQ9XS+al+vJbGRsQQDPPmhhXrAP6qCZfTKZ9sM8CEJBACaKACaKAA7zACaKALYgABNFABNFAPMgQBxB25m+4/MdOVGcuCCcKE5bkMMwH1tQ+m03cqIYXVBfgf1r4ECKFtRXYP8auIATxYkLwoni1AUNHY6CnONlqcYzv49Tl0Qs9It0o5hkQYW+rFZNgaegY5hhfrNUVx5R0BGaRDGfrSjoGNtEMb+goKM0WswFk8HhHPjMBG1T6c2SgkSEkySoufY8UrhICBJkssDQkxWjFlRGcDR2QUZRwFnTkQta610tnSrHCBcBSYLUsR5jJuDE+xCCht2tb41iMa4zHrIFDSxIZDhZgqp90FNnJcRu9ofxBAjKdQdkDvdECBfEoYT0gppjGWFTo0YsqDmW0XUgwzNcGBIF1XvqD3MJmbRIQTHuqTduQYLCUZBrGEmCosyiH7OgPMbU5xELerp2GL6GmoInU9ACFh5sCp5EQZsl3McYbgKVREFVq1iAssNNwZMoaHuv7+6+euItyIHBpuB9roIGm4InU5C+EXou4v7dIgWtz24LdUd+7s0fr4rqgQvL1Ki60LQTRSXIdkRx4omiaUF591nDiQ/zpg8qLOnitBPFegy3HVGceAtygIkiYsqJosO+mE+4MCQKqjntvGH0U8/dL1ILKnPbYaEpJ4oNTBQ7qtJg2dXgMF/aZ3f0nihaZr0cEzTIVLODUcwyP7H3FmTxYmtBwwhyoe9E8bMX1HeiKFrQNlEMyhVHLKg+7WPbm/cKF7S0REGb5UL/Drv51ogFPb0yBzpSzlEULahpQZYjig7d1IgFqSOKpbnyu5POCw2PhAuqjEhBpoHYeyA4w2HUglxAMxwmL6jfcMIFpT/1LFuQgFPPogU5nXp2Dxe2tERBLqeePcKFLS1RkMOpZ59wYUtLFORw6tkrXNDSIgXhU89+4UKWlikofTjRgloHnGOEC1taoiCXmfYe4cKWligoaHyPdAZGtCAJkxdEC5IQjoJclxYnKE4PXZ5W1+ywB5MpKMZAf5Kgw1eegvo8ST8KQSGfjqAgAAUBKAhAQYBGUIypHeV4BSUNR0HOy1AQWIaCwDIUBJYJFtTDPse4BIVUA9Zu6HBHvm4KOlqUgkBRCgJFKQgUHZOgCBfUWY6vRhQUb8D3ChDjgrrgHNCvBQ0qKMrlUGMW1H1B3V6LzkTTnyA+Th3Bx6kj+Dh1sk/PgtJ2x8fxXIN+xPiEd6rCwIVOLu4LBUUIT0ExqkBBsgqdXNwXCooQnoJiVIGCZBU6ufj0oCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD+BaGbgegpNfYTtWuHO0I4hHGrzx69C1rD26JV615ktnujqdvPrYEhhzBu9dmnb0H6tla2Ag/zRWl/gLKZM2G9U7pLGMf67NO3oGL21qVCtgbiuu4gjFd9dvQs6OGrW6dt3vYM0ypG6XhjCPgoVNf67OhXkNo6XCpknU5jmgVuHA6zclzr06JfQY63tFrDPtpJkD2MR33a9CpIbxy4QuCLd93E8Kwux/o8oy9BhcpKinrCycJSpjV3tgPHThqFqT/QUp+jpE8U4V3TnIZ59zuFC2lBO0CFHubwi3dJFB3CuNVnn+SC6mZvXf8C72q4hHGqzz7cWQVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQGkC1ITywIfjhuGdEHN002TIV1QuX7x16uwJ3eGIV5QmTtcgNEj8gWhR9z3jHhBm+X3Qc+KCUW8oGL2X5QnwJ6KdEHqBrthDzAPRLogNWl3s0zYTUsXlBwKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwP42O1zG/+p+HAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.10</span>,<span class="fl">0.11</span>,<span class="fl">0.12</span>,<span class="fl">0.13</span>,<span class="fl">0.14</span>,<span class="fl">0.15</span>,<span class="fl">0.16</span>,<span class="fl">0.17</span>,<span class="fl">0.18</span>,<span class="fl">0.20</span>,<span class="fl">0.21</span>,<span class="fl">0.23</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">42.0</span>,<span class="fl">43.5</span>,<span class="fl">45.0</span>,<span class="fl">45.5</span>,<span class="dv">45</span>,<span class="fl">47.5</span>,<span class="fl">49.0</span>,<span class="fl">53.0</span>,<span class="fl">50.0</span>,<span class="fl">55.0</span>,<span class="fl">55.0</span>,<span class="fl">60.0</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">lm.a &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">plot</span>(lm.a)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAe1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kLY6kNtmAABmADpmAGZmZmZmtrZmtv+QOgCQOjqQOmaQZgCQkGaQtv+Q27aQ2/+2ZgC225C2/7a2///bkDrbtmbb/7bb/9vb////AAD/tmb/25D//7b//9v///9YntJ2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMS0lEQVR4nO2dB3vbNhCG6dU2ldJE6jTTsK1Njf//C4vD4hDJO0xC9H3P48QDBMhXhwNwGKyurEVVa99A6WJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYEKKKCS1LAqoGWvuWyhLzQNQBOu9316aqnt7WvJ3y1AGqn95OL8/X+nnN2ylPFtB5f7i2lfh6/L7qDZWmAaBawGkY0EC9KvZ83j+9nfdcxQbqO+nq4fVyZD5DcTOPiAEhUoBE9bJK7KRlUZNlQDMxVI13ytrDxHUxlduCoCchnvzh9fZPPoDSwgHlBqT6oZNtQemATDVLWsUGZMTApoIfa/H/QT8s/G5nEnSAWvPr4TWnFzE2+ldC0inO+697mVssDYYazbMoMu1H0laWUCPqGQwAwajU9wf5/+nFELKAoGLKHtrUNRKsSXHei982UzXYU72e9O7aihtqEo9W4UOXRgoFyoI/v17l5yIeVP3OjnYMoMtR/vrhdeoa+TVMEfNTHgw1Tj9+l1+JdTlW0lC6p2graQCHVn709i8GkPqF+HfqGnXnJoU0p5ieyQKCzwA+mAyAhMSo7/SDrgfCrTx+U9bQ6q7GJCDx96lreoCkDaYCJEep9S5xFTMmIEzFfCv/19WlfegACJc7a0H9a3JZkGyBRUuWtp9oWjHhZow/kR5H+djD6MlmfVD/mrEPSgcoi1oZsmyhRYa2RgBThiB+YVqxrhs53YoNr9mNW7FUgOxoI8dQQxHQfZoGfq71h9/076BWd7S77QeZa0SScT8osQVxQHGkmyrGMemhbgCxCQ11A4hj0kONAXFMeqSbVownDofikCuiyICqu5EboGgx6cj2CKNnPTh0eCaKHAGBZPf/2obFmiIDOn16u55/+a4zjpm5OyAzjAwbzaeyoCp27u6AzPglrKMY2+WLui8/sAIAqYABMpMAQ0XJca47GbuK/fCqPjHI9/QScSDt5YPg0Rfj3SpMDlUxEyAIksv4s8hYGFNEh+0BSDVlS/ajjOxyhNB+ZguSUDpY4QX5AEJl3BRMEOUBBFEeY9KyRQNAUfxREkDGTV3r51yAerIBx3IB2Yo1H7pOOXARTvrnX1cCdN7vSCHXRk/IXI4JADV4Nz5epzGNBUUsd3QTcF29HEiWncbnXvog3RUgZRGXX5FBThszFuMByGkheUwnrX2KrOOpF7OMCqUkjLKQ3D2K0L9Y/Qt9HtSKwqXv0W8sFr6QPACQ/BfxQ+Gqro5OPvJC8gAfJJUakP0wfKpYjIXkAa0YjLsuvyWeUgkBFGUheWA/KOLKsGmFAMJFCMwWPwXg74Momu1AD8ovW96tmI7e1buFxNPLdwfZUctdWz4Bs4fXBpz0IqEW6cptGBDEMpqFUFjkcteWXz8IAJUVtE8mfwsibCCJUe7a8vZBTdh4ccuA+qsH05e7tu4qHkTS+3vU7PwnDjOV66Z3wBMVkf/Us19xIfEgTO+WTEREPk46xrxudEDvQygkRO/LcrvRyAvJIwOa4DGD6IYAom046TkW9psFKEh13wSgWVMgWAoW0tgCoBCPjM6+bgBQUIu1fUCBLfrmAQV3eCL7oNKWAUfoEMZvxQpaBhx32DUpn7FY+mXAxKFIBj5lLgMmTrfk4JNqGXBQuWjLopSFT6JlwGHlkgBFDvvMyjui6Gc/pHAHAVAuPIX2gzAflA9PoYCQViwjnmRTzx7lUqOMOc3nmm7q2blcatOeF0+yqWdYggYnJM02deNyUcd8E9pJE9e+UZqpZ8kHjvCZjfBTAc1GAokWF6wkU8+y+qlVsHMDEhzQcjCQ2JkMV5Kp5+6gnlk7W/JBlIh6yYAIU8/y7DknC1I+xXWyoVBAuM77x+/ShGaDIuPc6Gh6GZTpg8z63+XRvD6FbXYhXqXyrDzQ2BsqthVTscTwcIeqUgGZ5JAPoK9wiGU4oGxuJEhe/aDLsdoRAS3s9okIKGF184woNtXTPz4W1A93xAOU0mH7hlxDN+9X13jPlbSuesekoSUPLTdSzXAH5HLqDT1PhxuAY2qX585ift7OgFxMNw2gxpyF3VYzQZGoFcKxrjoBdQRE2xbeW8ZIH2qEyK2upgREUy/IQR6sZtT6gLJbkKMS+iDi4gUbC8njg5yVthWjLF5AD1ssfYRh5RNRLPAMs3Ty7ijydqhxwn5MGsTboUYJez4o8eKFouQdkw48X2XTgLKWu7b8fZBfcSl3+ySRfyuWqdy15eOki9wOlUpesxrlrJNOL3bSiBgQIg9AUV7ht2VAUV7ht2FAcV7ht2lAMV7ht2FAcV7ht2FAcV7ht2VAUV7ht2lAWctdWwwIUZppn4Vcth/uKGnPagbxtA8invZBxNM+iBJN+2RdQJVUaaZ9Mi+gSqkPufzFRR6A0OpT+gIqJ/kEzNDm62NbEGWzaswFVCv3uhNNHMZbQOW4gjW6/HvSecp1WnCZQt79oEzl3iEgt5nV0Hf73CGgsOKcwx3354Myl3t/rRjPrM4kdJpZ/ciDVcrM6ocerBJmVilDjbuRMyDCzCphsEostJjUhPwcZlYJFkQstJjUhPxcZlbxwSqx0GJSE/JzyhAdrBILLSY1IT/rpD+rYHSUxa5YocWkJuQ3BhT2dihiocWkJuSnMqy79i/G+0ewQotJTchvbEE5dJeAcuoeAZ1edvL4pOQv8rw3aUByjAoxxcBlwNuTcdIQkJYTP14vw96w7NEUJmyfox90TzKADmZmjAEN1QOk3E/YMHR76vkgufIlzvTYhqQBtQ+v8DJ1ygz9B5PpB7VyiH564Qo20v0s3F1JEpBftPZjiHkgYkCIstcpucxYhW6RDkWXiDKItqlJedPVuaBYOS6rlfFseTA+JpsItkegWyRsalLedHVcsmCS7+4gjmdMIjXbhA2ibZaRx0pjIokZNU+/A6CGUgNMIj0EQp7bZknKm64RjsQmJMxf+qD6J0Lw2yRSdQYzDJslKW+6BkBS1zCoLABIj2qWn8ImUu4HcUI2NSlvB/WQpPfTw/d2UB0RCdAoy3iOqJr5PoVkXekAkaK7IhGtig2zjBc5rmZ/iK9Gj2XMQxDbepqTHmYZr63P3pGuZdAAHhmxCZuI1Mzb1KS8HbQKID1HgDhSm4jUUbSpSXnTtQ4gOdWNegmbqKHM19nUpLzJ4rEqIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhWg2Q2Yh+kFuxWv011MyKhTivQiNqPUD9bTPwyBOPzYCMGNCtLCDxuKcXe2ZKY5aowpKXPyQgvSRKfK8Xtogr9B7Sw9VeIPNIAK4IQJ0Fwa5HuYUfNva1alWQ2gQp0pttkX1A5gK7rz22ygJk9xUrq6lVFYPlieIv8vAM+EMPkL0g2V7ktVuxwwBQa+qUel7tg7q/wLaWASB7wXmfiFBZFtSatr/pA4Jlh7XyT4/fhhZkL1AnGG7eB9lma2BB4qe/9/rUjFEVG7ZzdYKTR8oCZBtwvTZaP/B5/wV8NkBrTRXb6ZrVN5oU7X8pgHbKQUskYAjwTWvXttawQU4ZTwUpD5fj05uoVAd7gTSlwPfuTKoMQIKAaMVNP0hWr64fdLXv/IDVwDXs8Jekqq+mH6RMK83ZPjxYRcSAEDEgRAwIEQNCxIAQMSBE6wG67fZejl4dYXkCdrJzMksC5LfjXY/j20QnHxUEyG8k1eqet6f5oVoV0Onlqxgx7CBaelAjeLmfcsKSdMxM/9TbsttWOx0rS3Q63cqAYFgKFtBoOPCwU7YAG3s7AsM9zRpQipHqdXVAO32KrIxc7PS7GdTjQwQMdkj/KVO3j393bngSUKJDVlcGZI5vtKEdYUbaUlo5yLenw9eVPetksPveAqK8Qc5D5QCyG96nt3T3ZywmLWjzgJQFnT//NdmjuRy/dFH5jwoIHvBy/GmyNWqe/uve6vExfZA+fKKZPPtHRvRnJnY23Yr1AakHnT6WBAK0c8fMbrUfdCPlhE6f/J4z1YqGggCpHnTj6Wq3Nxa7lehCe5+2u8HR/J2IASH6H3aV4W/gy83hAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kLY6kNtmAABmADpmAGZmOpBmZmZmtrZmtv+QAACQOgCQOjqQkGaQtpCQtv+Q27aQ2/+2AAC2ZgC2tma225C2/7a2//++vr7bkDrbtmbb25Db/9vb////AAD/ADr/AGb/OgD/Ojr/Omb/OpD/ZgD/Zrb/kDr/kNv/tmb/tpD/trb/tv//25D/2////7b//9v///8UQxniAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPzUlEQVR4nO2di5bjOBGG3TcYSA/M9Daz0HjZXQPtWS7LYtiQzvs/GFbpYsmWXVJJtpVM/eekO05k2f4ile6q6sxaVLX3DZQuBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgGQKfHw7mpqrvXHe+mQA2A6rvX48P9ub7f8W4KlAF0enw6d1X/uv1uz/spTg6guofTMCBHVha7Pz3evZ4eOYs5so10dfPy9sx8XK1SzL89V6CD5zuRlaW6m5eFb2dVb1vOrgQI0qGw+QtiQEh+vSRAvf0xylCKaTLwLI3Ka8eH/s2TQtB/ePPp5gUO4E8NX8J7FRBOEf96kMNHNiAZswmkr3R6/0k8RK1PqeW1hjuJ0uopqOlv7fignqPPdBJH/wBdZQGqVcj+vQ5o4qnv/jJ8ZAFSMetAr/pKojA+mxjNtcydxGlNQA0kGHFHfe1TV0BlGhHPWg+ATu9fZHrp39s1VVEp62NwKq8akIlZBTLH8MbEaF1LfR/3LE4xny+LyaietKHp7/L0KCOGGju87ewsJlKIzIA6oAksglk3pQFZMUMg5/hsYjTXMt/HPYvTFmvu4yPwCVKQaNjBTSpWQE3aoGYCqDcPt3+SKUgHlDd1D0CcjzQgE7MMZI6NlYMYzbWG8FGymhqHc9dfu8lQSMgs1gmL6BZVKldNUhD8LCqL6YDwv7v9VqcH/ZGbgoZA5hjiMDGOUlC0nLbY8ZffwStVygbV0upaX0AO0nahUXahP4Kn6KoB0PD/g85dhp2xQU8m1g9ghp6sgCZG61qkvGEAvT0fwLJlBATFiSxJ1A+oE434sIOWzd1rn32eZOKpDmCkVUAZVV3dq6NulIJMzCqQOTYpCGJ0SzGTDoM12CCRWetDxiwm7MBB1j7kz1lVJkmpehCUDB+lDbp50RlQBpSShbv9UW2aMTpmXQNQx8MVXhS+6vYbEc6Ej5FVzPe2rr/f6+ztoPdyXX2fNNggWQci6eoByeoAve5ilWL52mLXpHEK4i7pkSZZjEc1XE0AcRJyNQGUNqpR7a82LBgVUOKoRvZCsSWc0gacFA9Il2JpFen8tYagx/WchnxPTkHLEpV1WaufyYgyuu+jIl1HCNh1AMlOUWgYbguImIwW0lEkoLBOe9HgF39FG30R0BoiEppDS0hB0L/lHYvRsnpkRoDiCweKaIzEidMz4wGZLop5Ky1T0FlUJnNmseNDaPNmNj0EnDn6gFKKyeSxVFHUWOZ7RaIAyQQneulydEKham2++rmPPyBnOT2KQosDl41qFr89Z7BBlXwdf/V6Pv0monZKTkbqdHPxXl0bDEh1yzW0ru1pdIFBK1IKSiMkAMur//j5P+GAZFGWmNYjspgGJK5LuGpiOorPYnlEAHT8xQuxhZyCaF9A4WH7lxiMg4FiklpiyXYJgFQpRk9BKYoEBGP/aE06+Lpx9aDOGuUhKzYZXYANyi1AFIzpIrLYGgq1SIS2WJalCLsDAgVAIgDKshShlP4gK7/BZAMxh88ZG6O1xdKXIpQCSEpUAToYrhezMvrS8qyLTiKg9KUIZWQxS/XN1w9/bFtxX7VIQpX1CpKVxXIsRSgO0NnM52kfX6z2jaretO0/Zaif+sTmLdBsI51hKUJZWQykAL09H3rDVJ1VSxVu9O1vP59/+heE+vHnmdOvpx40JwlIze8Q9ze05k8/6IrQ29//N3P6tdWDplKlmCrDHBt07PPX6bNAcxL23JuI3O6Ou9eaPJFmHF0pgomXw9xduxTrDKBj/9efiqwOs5uXRhjpJEKFZrEGWpkAqbV6FIcUBPLaIafLtVkY0AlTgYAcmTr2yAaBlgHBdO4eUI6KYqmymiCqFPu3KsVEZnv7h++cSQpKW21UMiCnhWbXg0Qi6utBn70F2dgGNQvT+QLGX4vNYuNWPqEmLZ9/setqfrTHHVktDtC0eU8BFCC0ol1kFvP1flCGnkPKd2QZaoGAZnrQ6EPPaSoti812nRGyWJaRhbIALfQsUlJQvlGNMrTY8bqSkd40uqTZRljn/b6AsmSxqH6/kfBe+8sHVFl/I7XONOA8yhedHxCe7QIHxq4UEJrtgkegLz+L+WBg2S5igD4SULa9O3LWg6bZaRlQ1PwFSkURnQac87oJsXuvETtLiNIWQ6cB57wuPXrfJYBO1LXpbbGyh559pVgrB07jCNFb8zl6FHMCwgp2K/GsC2jzacDhES5Eao9RrA0o4zTgfFp88tHE+ZVtUB5lzWKtLc+3zoUjW7bXAMg1Lu1YaZETs1hJQ8+DdVmj7kAx0vmGnnPIDIGuswaNVsyjQ896c7LZMClZzEGRmIPwi0UHDBl6bvQ2hN3cfoQJgJzMtDafhBS0UFG0RobmGiT07OAU6Kvzodug5aFn8103s2b1+z7x0F6V9b4lxhHxIlcUlyrSwSmIksWsAp1wNvFyOQMKmeS1pg3ahM9aFUV0/4qUIlmWYtvwIZVisj9o5wlUG/GhjazKLfd27Q/aig8J0MdHYaG3AuStIW/Gh1ZR7OvJh62ymLeNtR0fapdrU939eRNA3n6eDfmQ+6TD99FYig7PYj5AW/Khd9o7e1tTrxsEaLxXzKZ8yh96rir5MtqWzyUAAkTmeGM+8UPPW6+bHxmhrfmU3yftAtqcT/lZzKkIbc8nPotlnd0RFlTb6NQBCpIoHWb5ZndEtMWSx2+IonS55pvdEQgofXSLLnJFcbvujiQ4yYNBtE57oYtYL5Y+nEiyQdlmd6y9FMHb1KVEERdw403ekq+yOaAc2iaL7QIobL1YtuumX2ZrG3RZ68V2KMWSyvfS16xORRrVuLL1You6biOdQcV3d+wtAqAsTiCTAMH0LH9FTE9887alu5H7uS6guFG9GDE7UGVxApmSIGV3gt+FHAbIDRsKKGoHqjxOIBMAqZ8GfApMpAF5HQySAUXtQJXHCWRCFtO/zH/F9YVTMECi3gCgpjqcfvt6tv0aOz6R5Rfir5gpVynfyB8fZWixh9D9WTs0hhuN2oEqjxPIESA9oXnu/3mo8jm7XkiHmffDG7lN6OAA2vg1tnwiu86SjW/kG+n+UR6IWL5q24cDXDRuB6osTiCjs5hpNNjzj2WzpxOb8qk3wp9xNe2wcnwi286SLd/IB+W+9wA9UNqh8SgFgZY3WMrjBDIW0NDstAHJ5+7/mjenx3d6Ups99ut4tLWdJcOXxjk5uLp9hCSrHRqPbBAIA5RDsTZoAGRnMclFe/CV7mtvvpZbjZ5tv8auT2TLWbLtG7nPzX1M6uzObhNF7UCVR3RAJm931ZMvBR2cvk5VGXB9IqsvjD0Sqaa1nSWfhxLPrgcF7EC1x7DPcIL8Pa1i3muDnCqaAjL1U6ycJbdV/xStlcV0DtYB9x32iTqj0nYabuDtWdyAtxSDImvk11j7RD5pb9gA86G1fSOrVQT9tyIbK4fGlA6zzYd97FOknTZNDW89SM0zdVwd2/UgsC9ftX0VSEyIH3wjG6tk6kG339E7zDafxJmh/xRE29M+POBuwz4aUNrkNqpXhIiAuy3qlTZIrzaKVlzKsS8qFOMVYbdhH7DT4CQq3kELdXxWPXeMd6gQregEkgAo3bdPnHcoXKFOICnSRXGotvcOhS63XNkJZG+kf/27l7CwufyLRQGq0TJk3gnkKDpqn3SYo7qcHuoiAAUsd17JCaS6vnBUh3ocSGGT6OMwpKMy1AkkSR1ehNLxzHrJjHECGeAwYs4J5GhkdSWt4Wc1wgZh+9gGKc0GzYvsyzifp97woeeleSBq7XOVWYE+5GPOiwYULnyijD/S5E9XinZZDAjRcErw0POXCih46PkLBZRn6HnpPi4eUI6h56X7uHBAeYael+7jwgHlGXpeuo9LB5Rl6HnpPi4eEMunwUir7s7t/VKXrQmgNP9i1ycFqB5acTlWJFyRJimI5YqNNCLTs/ZwgF7PiIGXL0MKkJkZmThP+vqkjbTokIaBnzR36tcnCQjGfGS3PdeDXGlAT8MMWQZkywKkJvxlaKxekywbBFMHUv2pX50UIJj7KNIOPkLvlVNBMAcx1YZRWO0EXdTtw34yJ4KGcgte6XqQHPg9PtAymJhgaubHmgPn05gYzHR6Pf07NgLRoIy+Bb+y1KRlN76qIJgD59OYGODnitwW1InAFMoxtzCjLICUeZdPYw6cT2NiEDOmJRp8uoc/AiEBKOYWZpQHEOQE9XObA+fTmBjO5m39LrR7YXoxUebE3MKMsgCSuVzldXPgfBoTA3wgHkqVG0EuhEcRdAA25hZmVDSgyduICGCqYCmAVsti8ruQ9rPnYj2XUrJYbiN9dgGFlPWei5nlVPsb6ezFvAIkny8oATgRmPNKKebzVxR1KQa9MEHFmBOBWHACcAqpKJqqvWzJmXp+E1HPd2IwyUYt7o6OwJwXcwtecZ80IgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhYkCIGBAiBoSIASFiQIgYECIGhIgBIWJAiBgQIgaEiAEhKgFQ2t6WK4sBIWJAiMoCJD0WqPlPNy/q+Hx6/0nMmzZzWmq5BbAOv6qKAgQzdx8OaorP3as61rNd9XoS7QpBh1/15koCZNZjiUmF4H5aHcvdpLWjA8sVwgbrt0oCpD0WPKn9xZ1jGULkMbORvfl+zZsrCpBauf8kclP/oTmWgLSjA+MKYQi/oooCNMyTv/1Wb1IvNKz3E39GKWhllQRo2Az09PgBzNDg6kDZmmFhdjPymbWWSgKkPRaIP3J/fnVsUhA4OnBLsRl/W9lUBCCzaUijd+HrzCTeyiQl7egATrj9RoQz4ddTCYBI2mp19gUCAhsUsLtzHl0gIFkd2GoHjUsEtKkYECIGhIgBIdoP0LQe/PZMsrywScNqO4yVBCh8lbwbj6xartQtWRAgWtNKb9JATH6odgV0fBBeYg/CdaxqjcIaTE9KUl1o6sha5ms2aVhrX5+dAUG/c/+AjYIjHtaXFsQC1IGAuw5aAVqp82NnQAe1/55yhCl3tZaPL3wNiQ1pfg+hu9tvBzPsBbRSz+LOgKyOMGmC+mSkUopwil4P3lpqvY0QeHS22xqd9j+7SuusHEBmsbt/GbjtF8Wbgq4ekExBp/d/8NZo3p4/zO3F8OUAkt7L3nlLo+bur4Mzhi/TBqkdJBrvUKntDXysqy7FpqMV/q1M5F4T/pr2tdaDJpJGSDiDpJ+dXwUBkjXohmhqr68tNlVfhabuU3iNrfkLEQNC9H+EVC1vk2AFOgAAAABJRU5ErkJggg==" /><!-- --> the <span class="math inline">\(R^2\)</span> is 0.9480667</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># try another packages to plot</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># Stacked barchart</span></a>
<a class="sourceLine" id="cb11-4" title="4">(pie &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(<span class="dv">1</span>), <span class="dt">fill =</span> <span class="kw">factor</span>(cyl))) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Pie chart</span></a>
<a class="sourceLine" id="cb12-2" title="2">pie <span class="op">+</span><span class="st"> </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># The bullseye chart</span></a>
<a class="sourceLine" id="cb13-2" title="2">pie <span class="op">+</span><span class="st"> </span><span class="kw">coord_polar</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="tables" class="section level3">
<h3>TABLES</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">library</span>(survival)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">data</span>(veteran)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw">kable</span>(<span class="kw">head</span>(veteran),<span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">trt</th>
<th align="left">celltype</th>
<th align="right">time</th>
<th align="right">status</th>
<th align="right">karno</th>
<th align="right">diagtime</th>
<th align="right">age</th>
<th align="right">prior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">72</td>
<td align="right">1</td>
<td align="right">60</td>
<td align="right">7</td>
<td align="right">69</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">411</td>
<td align="right">1</td>
<td align="right">70</td>
<td align="right">5</td>
<td align="right">64</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">228</td>
<td align="right">1</td>
<td align="right">60</td>
<td align="right">3</td>
<td align="right">38</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">126</td>
<td align="right">1</td>
<td align="right">60</td>
<td align="right">9</td>
<td align="right">63</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">118</td>
<td align="right">1</td>
<td align="right">70</td>
<td align="right">11</td>
<td align="right">65</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">squamous</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">5</td>
<td align="right">49</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">kable</span>(<span class="kw">head</span>(iris))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">kable</span>(<span class="kw">head</span>(mtcars), <span class="dt">caption =</span> <span class="st">&quot;Data of Cars&quot;</span>)</a></code></pre></div>
<table>
<caption>Data of Cars</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw22019-9-29" class="section level2">
<h2>HW2:2019-9-29</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p><strong>3.4, 3.11, 3.18</strong></p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<div id="section" class="section level4">
<h4>3.4</h4>
<ul>
<li>Rayleigh密度为<span class="math display">\[f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0\]</span> 给出一个能够生成服从Rayleigh(<span class="math inline">\(\sigma\)</span>)分布的随机变量的算法. 选取一些满足<span class="math inline">\(\sigma&gt;0\)</span>的参数，并验证生成样本的众数接近理论众数<span class="math inline">\(\sigma\)</span> （验证直方图）。</li>
</ul>
<p>由Rayleigh分布定义，设<span class="math inline">\(Y,Z \quad i.i.d\sim N(0,\sigma^2),X= \sqrt{Y^2+Z^2}\)</span>则<span class="math inline">\(X\)</span>服从Rayleigh分布，我们利用定义生成<span class="math inline">\(\sigma=2\)</span>的理论Rayleigh随机变量X1。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">#根据定义生成服从Rayleigh分布的理论随机变量X1</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb17-3" title="3">sigma =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb17-4" title="4">n1 =<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb17-5" title="5">Y =<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sigma)</a>
<a class="sourceLine" id="cb17-6" title="6">Z =<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sigma)</a>
<a class="sourceLine" id="cb17-7" title="7">X1 =<span class="st"> </span><span class="kw">sqrt</span>(Y<span class="op">^</span><span class="dv">2</span><span class="op">+</span>Z<span class="op">^</span><span class="dv">2</span>) <span class="co">#X1服从参数sigma为2的Rayleigh分布</span></a></code></pre></div>
<p>接下来我们用<strong>逆变换法</strong>模拟X2也服从参数sigma为2的Rayleigh分布。 通过对概率密度函数积分，我们可以得到Rayleigh分布的分布函数：<span class="math display">\[F(x ; \sigma)=1-e^{-x^{2} /\left(2 \sigma^{2}\right)},\quad x\geq0\]</span>设<span class="math inline">\(U\sim U(0,1)\)</span>,则随机变量：<span class="math display">\[
F_{x}^{-1}(U)=\sigma \sqrt{-2ln(1-U)}\]</span>服从Rayleigh分布。</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co">#采用逆变换法生成服从Rayleigh分布对的随机变量X2</span></a>
<a class="sourceLine" id="cb18-2" title="2">U =<span class="st"> </span><span class="kw">runif</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb18-3" title="3">X2 =<span class="st"> </span>sigma<span class="op">*</span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>U))</a></code></pre></div>
<p>通过直方图来验证生成样本的众数和理论众数。粉色为真实值，蓝色为逆变换法产生的模拟值。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">hist</span>(X1,<span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Rayleigh distribution&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;X1(pink) and X2(blue)&quot;</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">hist</span>(X2,<span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>通过直方图的对比我们可以看出生成样本与理论众数是基本一致的。</strong></p>
</div>
<div id="section-1" class="section level4">
<h4>3.11</h4>
<ul>
<li>生成一个大小为1000、服从正态位置混合变量的随机样本。混合变量的分量分别服从N(0,1)分布和N(3,1)分布，混合密度为 <span class="math inline">\(p_{1}\)</span>和<span class="math inline">\(p_{2}=1 − p_{1}\)</span>。对 <span class="math inline">\(p_{1}=0.75\)</span>画出叠加了密度曲线的直方图。对不同的<span class="math inline">\(p_{1}\)</span>值进行重复，并观察混合变量的经验分布是否是双峰的。推测能够生成是混合变量为双峰的<span class="math inline">\(p_{1}\)</span>的值。</li>
</ul>
<p>令<span class="math inline">\(Y_{1}\sim N(0,1)\quad Y_{2}\sim N(3,1)\)</span>我们构造混合随机变量:<span class="math display">\[Y=p_{1}Y_{1}+(1-p_{1})Y_{2}\]</span> 接下来我们生成<span class="math inline">\(p_1=0.75\)</span>的混合随机变量，并生成叠加密度曲线的直方图。</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">n2 &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb20-2" title="2">p1 =<span class="st"> </span><span class="fl">0.75</span></a>
<a class="sourceLine" id="cb20-3" title="3">y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-4" title="4">y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-5" title="5">r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p1 , p1))</a>
<a class="sourceLine" id="cb20-6" title="6">y &lt;-<span class="st"> </span>y1<span class="op">*</span>r <span class="op">+</span><span class="st"> </span>y2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>r)</a>
<a class="sourceLine" id="cb20-7" title="7"><span class="kw">hist</span>(y, <span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>,.<span class="dv">05</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw">lines</span>(<span class="kw">density</span>(y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>通过观察，<span class="math inline">\(p_1=0.75\)</span>时，密度函数近似是双峰的。</strong> 接下来我们猜测产生双峰分布时<span class="math inline">\(p_1\)</span>的可能范围。根据分布的极限理论，为了更好地观察分布形状，我们增加产生的随机变量数，并模拟画出从<span class="math inline">\(p1\)</span>取值在0.1,0.2…,0.9九种取值范围内的概率密度图。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">n3 &lt;-<span class="st"> </span><span class="fl">1e5</span> </a>
<a class="sourceLine" id="cb21-2" title="2">y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {</a>
<a class="sourceLine" id="cb21-5" title="5">  p1 =<span class="st"> </span><span class="fl">0.1</span><span class="op">*</span>i</a>
<a class="sourceLine" id="cb21-6" title="6">  r &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size =</span> n3, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p1 , p1))</a>
<a class="sourceLine" id="cb21-7" title="7">  y &lt;-<span class="st"> </span>y1<span class="op">*</span>r <span class="op">+</span><span class="st"> </span>y2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>r)</a>
<a class="sourceLine" id="cb21-8" title="8">  <span class="kw">hist</span>(y, <span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>,.<span class="dv">05</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>通过观察，我们可以估计混合分布具有双峰性的区间大约为<span class="math inline">\(p_{1}\in[0.25,0.75]\)</span>时，混合分布有双峰性。</strong></p>
</div>
<div id="section-2" class="section level4">
<h4>3.18</h4>
<ul>
<li>写出一个基于Bartlett分解的函数来生成一个服从 <span class="math inline">\(W_{d}(\Sigma, n)\)</span> (Wishart) 分布的随机变量，其中<span class="math inline">\(n &gt; d + 1\geq 1\)</span>。</li>
</ul>
<p>假设<span class="math inline">\(\mathbf {M}=\mathbf X^{T}\mathbf {X}\)</span>,其中<span class="math inline">\(\mathbf{X_{n\times d}} \sim N_{d}(\mu,\Sigma)\)</span>,则称<span class="math inline">\(M\)</span>服从以<span class="math inline">\(\mathbf\Sigma\)</span>为尺度矩阵、以n为自由度的Wishart分布,记为<span class="math inline">\(\mathbf M \sim W_{d}(\Sigma,n)\)</span>。为了提高计算效率，我们可以采用基于Barlett分解的方法：</p>
<ol style="list-style-type: decimal">
<li><p>令<span class="math inline">\(\mathbf {T}=T_{ij}\)</span>为<span class="math inline">\(d\times d\)</span>下三角随机矩阵 <span class="math display">\[\mathbf{T}=\left(\begin{array}{ccccc}{c_{1}} &amp; {0} &amp; {0} &amp; {\cdots} &amp; {0} \\ {n_{21}} &amp; {c_{2}} &amp; {0} &amp; {\cdots} &amp; {0} \\ {n_{31}} &amp; {n_{32}} &amp; {c_{3}} &amp; {\cdots} &amp; {0} \\ {\vdots} &amp; {\vdots} &amp; {\vdots} &amp; {\ddots} &amp; {\vdots} \\ {n_{d 1}} &amp; {n_{d 2}} &amp; {n_{d 3}} &amp; {\cdots} &amp; {c_{d}}\end{array}\right)\]</span> 满足<span class="math inline">\(c_{i}^{2} \sim \chi_{n-i+1}^{2},\quad n_{i j} \sim N(0,1)\)</span>,元素间彼此独立。</p></li>
<li><p>矩阵<span class="math inline">\(\mathbf A=\mathbf T\mathbf T^{T}\sim W_{d}(I_d,n)\)</span>。</p></li>
<li><p>再对<span class="math inline">\(\Sigma\)</span>进行choleski分解<span class="math inline">\(\pmb\Sigma=\mathbf L\mathbf L^{T}\)</span>，其中<span class="math inline">\(\mathbf L\)</span>为下三角矩阵。</p></li>
<li><p>这样就有<span class="math inline">\(\mathbf {LAL^{T}}\sim W_{d}(\Sigma,n)\)</span></p></li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># 写函数 利用barlett分解生成服从warshart分布的随机变量</span></a>
<a class="sourceLine" id="cb22-2" title="2">generate_wishart &lt;-<span class="st"> </span><span class="cf">function</span>(n,d,Sigma){</a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="co">#首先保证输入的参数满足题设条件</span></a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="cf">if</span>((n<span class="op">&lt;=</span>d<span class="op">+</span><span class="dv">1</span>)<span class="op">||</span>(d<span class="op">&lt;=</span><span class="dv">0</span>)){</a>
<a class="sourceLine" id="cb22-5" title="5">    <span class="kw">stop</span>(<span class="st">&quot;n,d不符合要求！&quot;</span>)</a>
<a class="sourceLine" id="cb22-6" title="6">  }</a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="co">#生成d维零方阵</span></a>
<a class="sourceLine" id="cb22-8" title="8">  T1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</a>
<a class="sourceLine" id="cb22-9" title="9">  <span class="co">#赋值使其成为符合要求的下三角随机矩阵</span></a>
<a class="sourceLine" id="cb22-10" title="10">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb22-11" title="11">    T1[i,i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb22-12" title="12">  }</a>
<a class="sourceLine" id="cb22-13" title="13">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb22-14" title="14">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>){</a>
<a class="sourceLine" id="cb22-15" title="15">      T1[i,j] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-16" title="16">    }</a>
<a class="sourceLine" id="cb22-17" title="17">  }</a>
<a class="sourceLine" id="cb22-18" title="18">  A &lt;-<span class="st"> </span>T1 <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(T1)</a>
<a class="sourceLine" id="cb22-19" title="19">  <span class="co">#对协方差阵进行分解</span></a>
<a class="sourceLine" id="cb22-20" title="20">  L &lt;-<span class="st"> </span><span class="kw">chol</span>(Sigma)</a>
<a class="sourceLine" id="cb22-21" title="21">  W &lt;-<span class="st"> </span>L <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb22-22" title="22">  W</a>
<a class="sourceLine" id="cb22-23" title="23">}</a></code></pre></div>
<p>接下来，我们实际测试一下函数 我们构造一个4*4的对称正定阵，令其为协方差阵<span class="math display">\[\pmb{\Sigma_{1}}=\left(\begin{array}{cccc}{6} &amp; {2} &amp; {3} &amp; {4}  \\ {2} &amp; {10} &amp; {5} &amp; {1}\\ {3} &amp; {5} &amp; {9} &amp; {2} \\ {4} &amp; {1} &amp; {2} &amp; {7}\end{array}\right)\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">Sigma1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>),<span class="dt">nrow =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">Sigma1</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    6    2    3    4
## [2,]    2   10    5    1
## [3,]    3    5    9    2
## [4,]    4    1    2    7</code></pre>
<p>并由此生成自由度为6的wishart分布<span class="math inline">\(W_{4}(\Sigma_1,6)\)</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">W2 &lt;-<span class="st"> </span><span class="kw">generate_wishart</span>(<span class="dv">6</span>,<span class="dv">4</span>,Sigma1)</a>
<a class="sourceLine" id="cb25-2" title="2">W2</a></code></pre></div>
<pre><code>##          [,1]      [,2]       [,3]      [,4]
## [1,] 88.70630  33.92952  14.077081 46.919251
## [2,] 33.92952  57.08251 -13.522133 19.808105
## [3,] 14.07708 -13.52213  14.888734 -2.373911
## [4,] 46.91925  19.80811  -2.373911 43.809118</code></pre>
</div>
</div>
</div>
<div id="hw32019-10-11" class="section level2">
<h2>HW3:2019-10-11</h2>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<ul>
<li><strong>5.1</strong>计算<span class="math inline">\(\int_{0}^{\pi/3}\ sint dt\)</span>的蒙特卡罗估计并比较估计值和积分精确值。</li>
</ul>
</div>
<div id="answer-1" class="section level3">
<h3>Answer 1</h3>
<p>由概率论知识易知<span class="math inline">\(X \sim U(0,\frac{\pi}{3}),\quad\int_{0}^{\pi/3}\ sint dt = \frac{\pi}{3}E[sinX]\)</span>，由强大数律，<span class="math inline">\(E[sinX]\)</span>可由<span class="math inline">\(\frac{1}{m} \sum_{i=1}^{m} sinX_{i}\)</span>逼近。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">set.seed</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e5</span> <span class="co">#蒙特卡罗方法在区间中生成变量个数</span></a>
<a class="sourceLine" id="cb27-3" title="3">estimate<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(<span class="kw">runif</span>(n,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>))) <span class="op">*</span><span class="st"> </span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">cat</span>(<span class="kw">paste0</span>(<span class="st">&quot;蒙特卡罗估计值为&quot;</span>,estimate<span class="fl">.1</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;积分精确值为&quot;</span>,<span class="fl">0.5</span>))</a></code></pre></div>
<pre><code>## 蒙特卡罗估计值为0.501201485221179
## 积分精确值为0.5</code></pre>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li><strong>5.10</strong>使用对偶变量蒙特卡罗积分法来估计<span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^{2}}dx\]</span>并用未缩减方差百分比的形式给出近似方差缩减。</li>
</ul>
</div>
<div id="answer-2" class="section level3">
<h3>Answer 2</h3>
<p><span class="math inline">\(U\sim U(0,1)\)</span>，<span class="math inline">\(f=\frac{e^{-x}}{1+x^{2}}\)</span>是单调递减的，则<span class="math inline">\(f(U)\)</span>和<span class="math inline">\(f(1-U)\)</span>是负相关的。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co">#蒙特卡罗积分法在[0,1]区间的变量个数</span></a>
<a class="sourceLine" id="cb29-3" title="3">m &lt;-<span class="st"> </span><span class="fl">1e3</span> <span class="co">#重复试验次数</span></a>
<a class="sourceLine" id="cb29-4" title="4">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>) <span class="co">#被积函数</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co">#设计函数生成对偶变量估计积分值</span></a>
<a class="sourceLine" id="cb29-6" title="6">MC.anti &lt;-<span class="st"> </span><span class="cf">function</span>( <span class="dt">n =</span> <span class="fl">1e4</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb29-7" title="7">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-8" title="8">  <span class="cf">if</span>(<span class="op">!</span>antithetic) </a>
<a class="sourceLine" id="cb29-9" title="9">    <span class="co">#输入值为false,生成独立同分布的另一组变量</span></a>
<a class="sourceLine" id="cb29-10" title="10">    v &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)  </a>
<a class="sourceLine" id="cb29-11" title="11">  <span class="cf">else</span></a>
<a class="sourceLine" id="cb29-12" title="12">    <span class="co">#输入值为true,采用对偶变量法生成另一组变量</span></a>
<a class="sourceLine" id="cb29-13" title="13">    v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>u</a>
<a class="sourceLine" id="cb29-14" title="14">  u &lt;-<span class="st"> </span><span class="kw">c</span>(u,v)</a>
<a class="sourceLine" id="cb29-15" title="15">  <span class="co">#返回积分估计值</span></a>
<a class="sourceLine" id="cb29-16" title="16">  <span class="kw">return</span>(<span class="kw">mean</span>(<span class="kw">f</span>(u)))</a>
<a class="sourceLine" id="cb29-17" title="17">}</a>
<a class="sourceLine" id="cb29-18" title="18">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb29-19" title="19"><span class="co">#多次重复试验</span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb29-21" title="21">   MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.anti</span>(<span class="dt">n =</span> <span class="fl">1e4</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb29-22" title="22">   MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.anti</span>(<span class="dt">n =</span> <span class="fl">1e4</span>, <span class="dt">antithetic =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb29-23" title="23">}</a>
<a class="sourceLine" id="cb29-24" title="24"><span class="kw">cat</span>(<span class="st">&quot; 对偶变量法估计值为&quot;</span>,<span class="kw">mean</span>(MC1),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;单一蒙特卡罗法估计值为&quot;</span>,<span class="kw">mean</span>(MC2),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;对偶变量法标准差为&quot;</span>,<span class="kw">sd</span>(MC1),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;单一蒙特卡罗法标准差为&quot;</span>,<span class="kw">sd</span>(MC2),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;方差缩减比为&quot;</span>,(<span class="kw">var</span>(MC2)<span class="op">-</span><span class="kw">var</span>(MC1))<span class="op">/</span><span class="kw">var</span>(MC2))</a></code></pre></div>
<pre><code>##  对偶变量法估计值为 0.5248135 
##  单一蒙特卡罗法估计值为 0.5247576 
##  对偶变量法标准差为 0.0004703313 
##  单一蒙特卡罗法标准差为 0.00248883 
##  方差缩减比为 0.9642878</code></pre>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<ul>
<li><strong>5.15</strong>得到例5.13中的分层重要估计并和例5.10中的结果进行比较:考虑[0,1]区间上被积函数<span class="math inline">\(g(x)=\frac{e^{-x}}{1+x^2}\)</span>,选取重要函数<span class="math inline">\(f_{3}=\frac{e^{-x}}{1-e^{-1}},0&lt;x&lt;1\)</span>,其对应的分布函数为<span class="math inline">\(F_{3}=\frac{1-e^{-x}}{1-e^{-1}},0&lt;x&lt;1\)</span>。现在把区间（0,1）分成5个子区间<span class="math inline">\((\alpha_{j},\alpha_{j+1}),j=0,1,\dots,4,\alpha_{j}=F_{3}^{-1}(j/5)\)</span>。在第j个子区间上根据密度<span class="math display">\[\frac{5 e^{-x}}{1-e^{-1}}, \quad \alpha_{j}&lt;x&lt;\alpha_{j+1}\]</span>生成随机变量。</li>
</ul>
</div>
<div id="answer-3" class="section level3">
<h3>Answer 3</h3>
<ol style="list-style-type: decimal">
<li>找到5个子区间端点对应的20%,40%,60%,80%分位数。</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">#找到子区间的分位数</span></a>
<a class="sourceLine" id="cb31-2" title="2">quantile &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb31-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb31-4" title="4">  quantile[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="fl">-0.2</span><span class="op">*</span>i<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb31-5" title="5">}</a>
<a class="sourceLine" id="cb31-6" title="6">quantile</a></code></pre></div>
<pre><code>## [1] 0.0000000 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>用逆变换法在每个子区间上，生成<span class="math inline">\(X_{n}\)</span>为具有<span class="math inline">\(f(x)=5f_3(x)=\frac{5 e^{-x}}{1-e^{-1}}, \quad \alpha_{j} &lt; x&lt; \alpha_{j+1}\)</span>密度函数的随机变量。</li>
<li>在每个子区间上算出积分估计值<span class="math inline">\(\theta_{j}=\int_{\alpha_{j}}^{\alpha_{j+1}}\frac{g(x)}{f(x)}f(x)dx= E[\frac{g(X)}{f(X)}] = E[h(X)]=E[\frac{1-e^{-1}}{5(1+X^2)}]\)</span></li>
<li>积分估计值为各子区间积分估计值之和，<span class="math inline">\(\hat\theta = \Sigma_{i=1}^{5}\theta_{j},j=1,\dots,5\)</span></li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">set.seed</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co">#生成变量个数</span></a>
<a class="sourceLine" id="cb33-3" title="3">m &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co">#重复试验次数</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co">#h为原被积函数除以重要函数</span></a>
<a class="sourceLine" id="cb33-5" title="5">h &lt;-<span class="st"> </span><span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co">#MC.strat储存多次重复试验的估计结果</span></a>
<a class="sourceLine" id="cb33-7" title="7">MC.strat &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb33-8" title="8"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb33-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> n,<span class="dt">ncol =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-10" title="10">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb33-11" title="11">    y &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-12" title="12">    <span class="co">#采用逆变换法在子区间上生成满足重要函数密度的抽样</span></a>
<a class="sourceLine" id="cb33-13" title="13">    x[,i] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(y<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span><span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span>quantile[i]))</a>
<a class="sourceLine" id="cb33-14" title="14">  }</a>
<a class="sourceLine" id="cb33-15" title="15">  <span class="co">#将各子区间的积分估计值相加得到[0,1]区间上积分值</span></a>
<a class="sourceLine" id="cb33-16" title="16">  MC.strat[j] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colMeans</span>(<span class="kw">h</span>(x)))</a>
<a class="sourceLine" id="cb33-17" title="17">}</a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">#与来自于例5.13的原估计值和估计标准误差进行比较</span></a>
<a class="sourceLine" id="cb33-19" title="19">sd &lt;-<span class="st"> </span><span class="fl">0.0970314</span></a>
<a class="sourceLine" id="cb33-20" title="20">theta &lt;-<span class="st"> </span><span class="fl">0.5257801</span></a>
<a class="sourceLine" id="cb33-21" title="21"><span class="kw">cat</span>(<span class="st">&quot; 原方法估计值为&quot;</span>,theta,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;分层重要抽样方法的积分估计值为&quot;</span>,<span class="kw">mean</span>(MC.strat),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;原方法估计标准差为&quot;</span>,sd<span class="op">^</span><span class="dv">2</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;分层重要抽样方法的标准差估计值为&quot;</span>,<span class="kw">sd</span>(MC.strat),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;方差缩减比为&quot;</span>,(sd<span class="op">^</span><span class="dv">2</span><span class="op">-</span><span class="kw">var</span>(MC.strat))<span class="op">/</span>sd<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>##  原方法估计值为 0.5257801 
##  分层重要抽样方法的积分估计值为 0.5247959 
##  原方法估计标准差为 0.009415093 
##  分层重要抽样方法的标准差估计值为 0.0002064578 
##  方差缩减比为 0.9999955</code></pre>
</div>
</div>
<div id="hw42019-10-18" class="section level2">
<h2>HW4:2019-10-18</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</li>
</ul>
</div>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<p>Caculate the simulation results in Example 6.4, which the one side 0.95 confidence interval is given by<span class="math inline">\(\left(0,(n-1) S^{2} / \chi_{0.05}^{2}\right)\)</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># the sample size</span></a>
<a class="sourceLine" id="cb35-2" title="2">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># the times of replications</span></a>
<a class="sourceLine" id="cb35-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb35-4" title="4">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb35-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-6" title="6">  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb35-7" title="7">})</a>
<a class="sourceLine" id="cb35-8" title="8"><span class="kw">cat</span>(<span class="st">&quot;the confidence interval covers the variance is&quot;</span>, <span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>))</a></code></pre></div>
<pre><code>## the confidence interval covers the variance is 0.797</code></pre>
<p>the 0.95 confidence interval is<span class="math inline">\(\left[\bar{X}-\frac{S}{\sqrt{n}} t_{n-1}(0.975), \bar{X}+\frac{S}{\sqrt{n}} t_{n-1}(0.975)\right]\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># the sample size</span></a>
<a class="sourceLine" id="cb37-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb37-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co"># if.in.confidence is a vector containing TRUE or FALSE, indicate if the confidence interval covers the mean </span></a>
<a class="sourceLine" id="cb37-5" title="5">if.in.confidence.interval &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb37-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-7" title="7">  <span class="kw">abs</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">2</span>) <span class="op">&lt;</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb37-8" title="8">})</a>
<a class="sourceLine" id="cb37-9" title="9"><span class="kw">cat</span>(<span class="st">&quot;the confidence interval covers the mean is&quot;</span>, <span class="kw">mean</span>(if.in.confidence.interval))</a></code></pre></div>
<pre><code>## the confidence interval covers the mean is 0.918</code></pre>
<p><strong>We can see that if the sample data is non normal, the confidence interval covers the mean is not necessarily equal to 0.95, but the t-interval is more robust to departures from normality than the interval for variance.</strong></p>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span></li>
</ul>
</div>
<div id="answer-2-1" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">## the sample size</span></a>
<a class="sourceLine" id="cb39-2" title="2">q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>) <span class="co"># the selected quantiles</span></a></code></pre></div>
<p>calculate skewness <span class="math inline">\(\sqrt{b_{1}}=\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}\)</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">skewness &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10</span><span class="op">*</span>m,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb40-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb40-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb40-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-6" title="6">  m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb40-7" title="7">})</a></code></pre></div>
<p>Compute the standard error of the estimates from (2.14) <span class="math inline">\(\operatorname{Var}\left(\hat{x}_{q}\right)=\frac{q(1-q)}{n f\left(x_{q}\right)^{2}}\)</span>.</p>
<p>Using the normal approximation for the density (with exact variance formula).let <span class="math inline">\(f(x)\)</span> be the normal distribution density of<span class="math inline">\(N(0,\frac{6(n-2)}{(n+1)(n+3)})\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">var &lt;-<span class="st"> </span><span class="kw">matrix</span> ( q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>n<span class="op">/</span><span class="kw">pnorm</span>(q,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>( <span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>) )), <span class="dt">nrow =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-2" title="2">sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(var)</a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">colnames</span>(sd) &lt;-<span class="st"> </span>q</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw">rownames</span>(sd) &lt;-<span class="st"> &#39;standard error of the estimates&#39;</span></a>
<a class="sourceLine" id="cb41-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(sd)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.025</th>
<th align="right">0.05</th>
<th align="right">0.95</th>
<th align="right">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>standard error of the estimates</td>
<td align="right">0.048362</td>
<td align="right">0.0661897</td>
<td align="right">0.0492858</td>
<td align="right">0.035258</td>
</tr>
</tbody>
</table>
<p>Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">quantile</span>(skewness,q),<span class="kw">qnorm</span>(q,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">colnames</span>(A) &lt;-<span class="st"> </span>q</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="kw">rownames</span>(A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimated quantiles&#39;</span>,<span class="st">&#39;quantiles of large sample&#39;</span>)</a>
<a class="sourceLine" id="cb42-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(A)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.025</th>
<th align="right">0.05</th>
<th align="right">0.95</th>
<th align="right">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>estimated quantiles</td>
<td align="right">-0.9384496</td>
<td align="right">-0.7729476</td>
<td align="right">0.7631767</td>
<td align="right">0.9275825</td>
</tr>
<tr class="even">
<td>quantiles of large sample</td>
<td align="right">-1.0735165</td>
<td align="right">-0.9009234</td>
<td align="right">0.9009234</td>
<td align="right">1.0735165</td>
</tr>
</tbody>
</table>
<p><strong>We can investigate that there is obvious error between the estimated quantiles and the quantiles of large sample, this is because the sample size n is too small, the accurate normality variance is <span class="math inline">\(\frac{6(n-2)}{(n+1)(n+3)}\)</span>, it will be close to <span class="math inline">\(\frac6n\)</span> as <span class="math inline">\(n \rightarrow \infty\)</span>. So when the n is small, <span class="math inline">\(N(0,\frac6n)\)</span> is not a good approximation.</strong></p>
<p><strong>Instead, let’s try the normality approximation with accurate variance.</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">quantile</span>(skewness,q),<span class="kw">qnorm</span>(q,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="kw">sqrt</span>( <span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>) ))),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">colnames</span>(B) &lt;-<span class="st"> </span>q</a>
<a class="sourceLine" id="cb43-3" title="3"><span class="kw">rownames</span>(B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;estimated quantiles&#39;</span>,<span class="st">&#39;quantiles with accurate variance&#39;</span>)</a>
<a class="sourceLine" id="cb43-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(B)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.025</th>
<th align="right">0.05</th>
<th align="right">0.95</th>
<th align="right">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>estimated quantiles</td>
<td align="right">-0.9384496</td>
<td align="right">-0.7729476</td>
<td align="right">0.7631767</td>
<td align="right">0.9275825</td>
</tr>
<tr class="even">
<td>quantiles with accurate variance</td>
<td align="right">-0.9268008</td>
<td align="right">-0.7777958</td>
<td align="right">0.7777958</td>
<td align="right">0.9268008</td>
</tr>
</tbody>
</table>
<p>In this case, two quantiles are quite close.</p>
</div>
</div>
<div id="hw52019-11-1" class="section level2">
<h2>HW5:2019-11-1</h2>
<div id="question-1-2" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</li>
</ul>
</div>
<div id="answer-1-2" class="section level3">
<h3>Answer 1</h3>
<p>First, we give a function to compute skewness, which is <span class="math inline">\(\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">skewness &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="co">#compute the sample skewness</span></a>
<a class="sourceLine" id="cb44-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb44-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb44-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb44-7" title="7">}</a></code></pre></div>
<p>If the null hypothesis is true , the skewness should have the distribution: <span class="math inline">\(\sqrt{\beta_{1}}\sim N(0,\frac{6(n-2)}{(n+1)(n+3)})\)</span>. Here we set the significance value to be 0.05</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb45-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># the significance value</span></a>
<a class="sourceLine" id="cb45-3" title="3">a =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dt">by =</span> <span class="dv">1</span>) <span class="co"># parameter in beta distributions</span></a>
<a class="sourceLine" id="cb45-4" title="4">N &lt;-<span class="st"> </span><span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb45-5" title="5">powers1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb45-6" title="6">n &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># numbers of variable for each simulation</span></a>
<a class="sourceLine" id="cb45-7" title="7">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># replication times</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co"># critical value for the skewness test </span></a>
<a class="sourceLine" id="cb45-9" title="9">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb45-10" title="10"></a>
<a class="sourceLine" id="cb45-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb45-12" title="12">  sktest &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb45-13" title="13">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb45-14" title="14">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a[i],a[i])</a>
<a class="sourceLine" id="cb45-15" title="15">    sktest[k] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skewness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb45-16" title="16">  }</a>
<a class="sourceLine" id="cb45-17" title="17">  powers1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktest)</a>
<a class="sourceLine" id="cb45-18" title="18">}</a></code></pre></div>
<p>Now we draw the empirical powers line.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(powers1), <span class="kw">aes</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> powers1)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="st">         </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="st">         </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;parameter of Beta(alpha,alpha)&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;powers&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="st">         </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>As we can investigate from the figure, the powers is too low, which means we can hardly reject the normality hypothesis, and it shows that skewness test doesn’t work well for symetric beta distribution.</strong></p>
<p>Now we do same things as above for t distributions.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">set.seed</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb48-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># the significance value</span></a>
<a class="sourceLine" id="cb48-3" title="3">mu =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dt">by =</span> <span class="fl">0.1</span>) <span class="co"># parameter in t distributions</span></a>
<a class="sourceLine" id="cb48-4" title="4">N &lt;-<span class="st"> </span><span class="kw">length</span>(mu)</a>
<a class="sourceLine" id="cb48-5" title="5">powers2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb48-6" title="6">n &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># numbers of variable for each simulation</span></a>
<a class="sourceLine" id="cb48-7" title="7">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># replication times</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co"># critical value for the skewness test </span></a>
<a class="sourceLine" id="cb48-9" title="9">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb48-10" title="10"></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb48-12" title="12">  sktest &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb48-14" title="14">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,mu[i])</a>
<a class="sourceLine" id="cb48-15" title="15">    sktest[k] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skewness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb48-16" title="16">  }</a>
<a class="sourceLine" id="cb48-17" title="17">  powers2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktest)</a>
<a class="sourceLine" id="cb48-18" title="18">}</a></code></pre></div>
<p>Again, we draw the empirical powers lines.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(powers2), <span class="kw">aes</span>(<span class="dt">x =</span> mu, <span class="dt">y =</span> powers2)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="st">         </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="st">         </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;parameter of t(mu)&quot;</span>,<span class="dt">y =</span> <span class="st">&quot;powers&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">         </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAADoAAGYAOpAAZrYzMzMzZv86AAA6ADo6AGY6kNs9PT1NTU1NTW5NTY5NbqtNjshmAABmADpmtrZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC22/+2///Ijk3I///KysrbkDrb/7bb///kq27k///r6+v/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9Fz0OGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALq0lEQVR4nO2dCXfbuBGA4USls3ayW7fettk27pG9XHurPSi7tePw//+rEvdBEIc4pABy5r1YIkfAAJ8GA4CkJqRDCQo5dQNKFwQUEQQUEQQUkSCgpz//xF4/ffP2q9/Uy7YkBOjh7ZcM0OdvP3S//l6+bEwCgO7f/cA96NPffqLOJF6Eth2VMlRT60sApIbY019+6z799Ufx0p/4XS9Tv5laJAXQw1eMjHgROuAvfF0ehIBsQBiDIoA+f/uez2LvjVkMuD/1AqL/fOsg4P7UCSgkwP1BQEurygFECIFtGoyqGECEuIQQEALKA3SJgEKAWtI0sE2DUZUDqG0a9KCIB9ljDAENANmEEJADyHUhBGQDGowxBOQAolHaXAshoCEgixACcgG1CCgMiCCgFEBgTYNRFQWIWItpBOQCcrZjCGgAqLXGGAIaAUQGRsBbnaFCQBFVWYCsMYaARgBBNQ1GVSAg9KCA8CC0xuf5wDyoUbc30IM8gFoEhICmAlJhGgH5ABlrRQQUAEQAmgajKhBQg4BCgFoElAIIomkwqhIBNTBNg1GVB6hFQAhoKqAGpGkwqgIByYtCCCgEiCCgEKAGAYUAEQQUBiTGGAIKAGoQUAgQQUBhQPyJYAQUAgTQNBgVAoqoSgXUIKAQoBYBRQERgoDGATlPK4K3OkO1ACD1I+df31L5wF6/DP5ufvC7DeBWZ6jmB2Qne6F5Ke4/RD1o8NMf2FZnqOYHZCVaoCkpPn/3o6H2G6CAthKDrFQd1JX6IUcHWhfM/tKPsdEaq5RxQGayF/b69CfTi8a+gx7QxO8ORrWsBz2olBQqDo2ZaNyfsEK2OkO1bAy6fy/PRgG1mwFkJHvhA4u60efvo+lxNgNIrINY9hc+0vp10Ds1kY3aCI2xdQEKy5gJ55ctsK3OUCGgiKpUQAQBJQCardUZqqIBjW7pEZAcYyOEEBAVBISAJgEigatmCKgNz2MIqEVAUUB8jM3T6gxVwYC68R09AhJGxlwIAUkjCAgBTQXkJYSAlBEEFDGCgMJGRq6aISBhhO/H4FudoSodkN+FEJAwgoCiMci/H0NAhpGtA4oKfVJoBWJ14vnq+vmKvLpLKRj7FrzzWO0edLvr9q/u9jsQQL4wXTmg3oFebnbdIcmFYka8Ybp+QM9XF2CAPA90Vg7o5ebicPaRDrTpgIi8gQja6gzVLDHo8ZzsutvXv4ABcl2odkA5EjFCiG+MVQ7o5eYaDJDfhSoH1AdpOECtz4UqB9Tt08JPGiDfPFY5oH4VzQRkmpePCoG2OkNVepCmMrwJjYBc+44LVQ9oT8h1YiBKsu9uyGoHdPv6Z74dQ0Dje7FroL0YEwQUs+/MY5UD6tdBP/MNPRygk/2XG/ME6QNdBiXx2SigDEmzvy5A/Uo6fTOWaN9eK1YOqN/OJ+80MuyvCJCgBDiLUTFcaAWA+jCdNswy7K8HUD/Eki94ZNjXLlQ5INgLZkLodXtFqHJA/WYM3IPEtWmgVmeo5opBj+cqBqnsLzLtiz6xYUDUjfgsZmR/4dkE7HQwifYFoOUzKc8CqHcfvdfQmRdEwg4rHUxODNIuVDmgfiVt7MN07g6R9kWfCGR/GQoHlPzx0iQl+4tI+2Kmg9mmB7FLrmo3b+UPonHIPpFqn5iEage0p+FZXg+yQ04PaEIMkqvpygGJheJBzmIy+4tI+2Kkg8kA1PInPLgLrQqQkf1FpH05Zh2kZA2A7CEWkVz7S6d5nT9IAwNaOovpjCvpNMm0zycyBDRmX/w2oXpAbIiBXzDTT1PVDmiuIC0Xi7UDcqZ5MEAEAYXtK0DVxyD6lPQMQ4woQpUDko/gJd0by7GvCFUOKEty7VuXXmfoEHR9iwPihCa2OkNVKaDlMgjWB4gS6hBQ2H7AhRBQy3dkY2lMEVC7bHqzWgGN/r8SCIhKgBAC4pfvEVBwmkcPCtlXgBbJvVQvoJGJDAGZ14Vm6BB0facAFCS0OkDHCtuRLW10giy7DhKqJVILndyDJthfJDFMxYBYGBqshRCQUonVInCHQAqVA2h42QMBaZV3qkdAlmoYhRCQqfLsWRGQqfLEaQRkqjw7DgRkqOSeTDwBC9IhkEKFANLXPYgmhIC0iliEgDoEUqg0QOZUhoAMFb96L/ZkBKZDIIVKAUSF8Wn1IENArsoZZAjIVTlhCAG5Kn0XiA02BOSqiE0IAQ1U9noRAflUJqGR/zcyr8KJhQoFFCO0YUAOIYAKpxUqD1Br5FVGQCMqRQiqwuMLlQmoFbcSR12oVED6R85PX9PUFDIJzAyALEIDUIUC0sleaLoFmp6CJ4GZCZC6ODQM14UC0okWHiim+w8iCcxcgOSuTACaejV2fkB2qo7+nUgC02Vmf0kSEagb0hFDYG0cJynZXzqep0IkgRHqiV+QK5JQawKaUuGyHvTpm/firIpDE+0PhCgnqgWQkezl6WsVnmcD1HkIiUBUKCCd7EXwEUlg5gLEnejS9iFGqFBAOvsLXf/Q8CySwMwKaEioXEBhmWjfq1KELEQISKmInxACUiq5lu4JXSKgUZWYzTwTfkaFKwfECVlTfmaFawakLlWzpXUbIrRRQOZNMx2O8ircBiAbUVaFKwfE5zOTkUDkcNouICkuIiJXArFHHjYFyGFkhG0E1MqF4nDi94w4wFZUA6g1diFN46EEeSukdkAGowEi4twS2SogPyXzUj/QE2u1AbIJ6cF2aWxq1cIAohXVAZJ991FSgIwxJ9xO16IPVgpIieEqhifZHsYKKWiiVFZ4qhgQFw6isyg5jKyjbQJq5X3GpvFTciTDVPWAWjGQfDHJR8mOQWRk+bQmQKYqgZJVyDjjqtS7tQLq5fKy8WEyCuljU0PMy9/rAuTc0R+hJN3FC8jFuDJAQpyOO0PO3ek6jmcTmgyoTCH8mRlC7OdoGkf69XfnpUMGz9ysy4OEcE8g9rrbw8kAJgTQg05OIaAyhorXSUZBNWuPQUKsaKtODEX6jQa02lnMEeLerx4ONy+q/2wFkFcTAqQitC6/VUDSmVovsU0DamVk6swTCCikckPTavdi0woR3zPrCCiiQkARFQKKqBBQRIWAIioEFFEhoIgKAUVUkwEdJcf9DO+oUlCmEFCkFAKKlEJAkVIru6sBLwgoIggoIggoIggoIgsCsnKjpAr7YbpOs5JRKNOcSOAyMLUgICs3SqI80D7qNCsZhTLNiQQuQ1PLAbJzo6TJ/bsfemcwUhykF8o0JxK4DE0tB0jnRskR2lo7zUpioSPM9TaGppYDZOdGSS7V99VKs5JaKN8cTTUxNLXwLJYdh472oGxzLIHLKT2IyVGAMmPQcYB4gpJTxiA7N0qq0NbqNCsZhTLNiQQuQ1PLroPeZU9kk9ZBGeZkApdTroPqFAQUEQQUEQQUEQQUEQQUkcIB/fffAeWenH1UH3q5ufZ+6PkPHye1oGxAj28CvXu+ujY+tN+NfOzw+pcpTagYkFSy13FHGXOtRFkS0OObfxBCv8/Hc0LIRff4xd/Jqzt58Oaf/ZsLenRNe0WE6kK8F5+m9dATO1YJ9Rr+oX1fr1UFw8b+THOhRQGdv7p7udnxsbGn/d91xkHfjz3lt+efon2mHVTvz8UgoifoP9ODXm4uaP1GFRpQ0A2jsiyga9bc/9FvtH9lx9aB/MSBukqPjvZNvT8XQ4WdOAgEvDDHbFWh2chYdZwsO8Rkcw/9qDr7KHpoHMg/e/7Y8gU9Nt8zYUNGIuhMQGYV+oB519FyCkDPV/30LPtgHShAImwwQMZ7JisGxLz/izvWw4NwGutA/jmc6b6b75mwE94h5gdU0RATQZr28PFcAjIP5J+Xmx5br6F9k+8VIDdIMwC3Fw6g5ys6/53VFaTpNE+nots+6PyLh2D7QP2hMznt3C3Zyfe6n3ya1yfohw5smjeroLP9H+nqaF/PND/pqwzLShaK8wFaxVZjVkDb3KwWIAgoIggoIggoIggoIggoIggoIv8Hfwi2KGFKHu0AAAAASUVORK5CYII=" /><!-- --></p>
<p><strong>We know the theorem that t distribution has the asymptotic normality property, so the fact that powers(the probability) is declining makes sense. Compared to the last example, we can conclude that skewness works better in the heavy tail condition.</strong></p>
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test<span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{1}: \mu \neq \mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</li>
</ul>
</div>
<div id="answer-2-2" class="section level3">
<h3>Answer 2</h3>
<p>We set significance level <span class="math inline">\(\alpha\)</span> to be 0.05.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">m &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co"># numbers of variable for each simulation</span></a>
<a class="sourceLine" id="cb51-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co"># replication times</span></a>
<a class="sourceLine" id="cb51-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb51-4" title="4">t1e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">1</span>,<span class="dt">ncol =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb51-5" title="5"><span class="kw">colnames</span>(t1e) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chisq&quot;</span>,<span class="st">&quot;uniform&quot;</span>,<span class="st">&quot;exponential&quot;</span>)</a>
<a class="sourceLine" id="cb51-6" title="6">test1 &lt;-<span class="st"> </span>test2 &lt;-<span class="st"> </span>test3 &lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb51-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb51-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(m,<span class="dt">df =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb51-9" title="9">  test1[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">mu =</span> mu0)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb51-10" title="10">  y &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-11" title="11">  test2[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(y,<span class="dt">mu =</span> mu0)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb51-12" title="12">  z &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, <span class="dt">rate =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb51-13" title="13">  test3[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(z,<span class="dt">mu =</span> mu0)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb51-14" title="14">}</a>
<a class="sourceLine" id="cb51-15" title="15">t1e[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(test1 <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb51-16" title="16">t1e[<span class="dv">1</span>,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(test2 <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>) </a>
<a class="sourceLine" id="cb51-17" title="17">t1e[<span class="dv">1</span>,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(test3 <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb51-18" title="18">knitr<span class="op">::</span><span class="kw">kable</span>(t1e)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">chisq</th>
<th align="right">uniform</th>
<th align="right">exponential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0786</td>
<td align="right">0.0533</td>
<td align="right">0.0666</td>
</tr>
</tbody>
</table>
<p><strong>We see the type1 error is close to nominal level 0.05, but the actual distributions in the simulations(i.e. chi-square, uniform and exponential) are far away from the normal condition, this indicate that the t-test is a robust testing method for departures of normality.</strong></p>
</div>
<div id="question-3-1" class="section level3">
<h3>Question 3</h3>
<ul>
<li>If we obtain the powers for two methods under a particular simulations setting with 10000 experiments: say, 0.651 for one method and 0.676 for another methond. Can we say the powers are different at 0.05 level?</li>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test,two-sample t-test, paired-test or McNemar test?</li>
<li>What information is needed to test the hypothesis?</li>
</ul>
</div>
<div id="answer-3-1" class="section level3">
<h3>Answer 3</h3>
<ol style="list-style-type: decimal">
<li>the corresponding hypothesis test problem</li>
</ol>
<p>First, we define two powers by:</p>
<p>The power of test method 1 = P(reject the null hypothesis in the test 1) = <span class="math inline">\(P_{1}\)</span>,</p>
<p>The power of test method 2 = P(reject the null hypothesis in the test 2) = <span class="math inline">\(P_{2}\)</span>.</p>
<p>And the corresponding hypothesis test problem is <span class="math display">\[H_{0}:P_{1} = P_{2}\longleftrightarrow H_{1}:P_{1} \neq P_{2}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>the test we should use: Since the data we can get is paired nominal data, we should use <strong>McNemar test</strong></p></li>
<li><p>the extra information we need</p></li>
</ol>
<p>We obtain the powers from the particular simulations with 10000 experiments, consider the result(whether reject null hypothesis or not) from the two methods for every single experiment, we can show it in a contigency table.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Test2 reject</th>
<th align="left">Test2 accpet</th>
<th align="left">row sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Test1 reject</td>
<td align="left">a</td>
<td align="left">b</td>
<td align="left">a + b</td>
</tr>
<tr class="even">
<td>Test1 accpet</td>
<td align="left">c</td>
<td align="left">d</td>
<td align="left">c + d</td>
</tr>
<tr class="odd">
<td>column sum</td>
<td align="left">a + c</td>
<td align="left">b + d</td>
<td align="left">10000</td>
</tr>
</tbody>
</table>
<p>Now from the power we alreay know that <span class="math inline">\(a+b=6510, a+c=6760\)</span>. And in the McNemar test, the test statistics is <span class="math display">\[\chi ^2 = \frac{(b-c)^2}{b+c}\]</span> <span class="math inline">\(\chi^2\)</span> has a chi-squared distribution with 1 degree of freedom if <span class="math inline">\(H_{0}\;is\;ture\)</span>. <strong>So we need information a, i.e., in how many experiments, the null hypothesis is rejected both in the test 1 and test 2.</strong></p>
<p>At last, if the <span class="math inline">\(\chi^2 &gt; \chi^2(0.05)\)</span>, we can say we the powers are different at 0.05 level.</p>
</div>
</div>
<div id="hw62019-11-8" class="section level2">
<h2>HW6:2019-11-8</h2>
<div id="question-1-3" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates:<span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec})\)</span>,<span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana})\)</span>,<span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta})\)</span>,<span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span>.</li>
</ul>
</div>
<div id="answer-1-3" class="section level3">
<h3>Answer 1</h3>
<p>First, we display the scatter plots for each pair of test scores, and calculate the sample correlation matrix.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">pairs</span>(scor)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<p>To compare more clearly, we can merge the figure and matrix.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">library</span>(GGally)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">ggpairs</span>(scor)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>We can find that if the test scores have a similar linear relationship in the figure, then the correlation coefficient will be bigger. </strong></p>
<p>Now we try estimate the standard error using bootstrap.First, we give a general function <code>boot.std.grades.cor</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">boot.std.grades.cor &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">replicates =</span> <span class="dv">200</span>, <span class="dt">sample.size =</span> <span class="kw">dim</span>(scor)[<span class="dv">1</span>],i,j){</a>
<a class="sourceLine" id="cb58-2" title="2">  <span class="co">## `replicates` is the number of replication</span></a>
<a class="sourceLine" id="cb58-3" title="3">  <span class="co">## `sample.size` is the size of generated sample in each replications</span></a>
<a class="sourceLine" id="cb58-4" title="4">  <span class="co">## `i`,`j` represents the indice of subjects in dataframe &quot;scor&quot;\</span></a>
<a class="sourceLine" id="cb58-5" title="5">  storage.cor &lt;-<span class="st"> </span><span class="kw">numeric</span>(replicates) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb58-6" title="6">  <span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>replicates){</a>
<a class="sourceLine" id="cb58-7" title="7">    index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>sample.size, <span class="dt">size =</span> sample.size, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb58-8" title="8">    storage.cor[r] &lt;-<span class="st"> </span><span class="kw">cor</span>(scor[index,i],scor[index,j])</a>
<a class="sourceLine" id="cb58-9" title="9">  }</a>
<a class="sourceLine" id="cb58-10" title="10">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">std =</span> <span class="kw">sd</span>(storage.cor), <span class="dt">mean =</span> <span class="kw">mean</span>(storage.cor), <span class="dt">simulation =</span> storage.cor))</a>
<a class="sourceLine" id="cb58-11" title="11">}</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">ro12 &lt;-<span class="st"> </span><span class="kw">boot.std.grades.cor</span>(<span class="dt">i =</span> <span class="dv">1</span>,<span class="dt">j =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb59-2" title="2">ro34 &lt;-<span class="st"> </span><span class="kw">boot.std.grades.cor</span>(<span class="dt">i =</span> <span class="dv">3</span>,<span class="dt">j =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb59-3" title="3">ro35 &lt;-<span class="st"> </span><span class="kw">boot.std.grades.cor</span>(<span class="dt">i =</span> <span class="dv">3</span>,<span class="dt">j =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb59-4" title="4">ro45 &lt;-<span class="st"> </span><span class="kw">boot.std.grades.cor</span>(<span class="dt">i =</span> <span class="dv">4</span>,<span class="dt">j =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><strong>Let’s have a look at the distributions of estimated cor in replications.</strong></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">hist</span>(ro12<span class="op">$</span>simulation,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;cor(mec,vec)&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;cor(mec,vec) from replications&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">hist</span>(ro34<span class="op">$</span>simulation,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;cor(alg,ana)&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;cor(alg,ana) from replications&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">hist</span>(ro35<span class="op">$</span>simulation,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;cor(alg,sta)&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;cor(alg,sta) from replications&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">hist</span>(ro45<span class="op">$</span>simulation,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;cor(ana,sta)&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;cor(ana,sta) from replications&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Now we give the standard error from bootstrap estimation in a table.</strong></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">standard.error &lt;-<span class="st"> </span><span class="kw">c</span>(ro12<span class="op">$</span>std,ro34<span class="op">$</span>std,ro35<span class="op">$</span>std,ro45<span class="op">$</span>std)</a>
<a class="sourceLine" id="cb64-2" title="2">mean &lt;-<span class="st"> </span><span class="kw">c</span>(ro12<span class="op">$</span>mean,ro34<span class="op">$</span>mean,ro35<span class="op">$</span>mean,ro45<span class="op">$</span>mean)</a>
<a class="sourceLine" id="cb64-3" title="3">real &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">cor</span>(scor<span class="op">$</span>mec,scor<span class="op">$</span>vec),<span class="kw">cor</span>(scor<span class="op">$</span>alg,scor<span class="op">$</span>ana),<span class="kw">cor</span>(scor<span class="op">$</span>alg,scor<span class="op">$</span>sta),<span class="kw">cor</span>(scor<span class="op">$</span>ana,scor<span class="op">$</span>sta))</a>
<a class="sourceLine" id="cb64-4" title="4">standard.error.matrix &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;subjects&quot;</span>=<span class="kw">c</span>(<span class="st">&quot;(mec,vec)&quot;</span>,<span class="st">&quot;(alg,ana)&quot;</span>,<span class="st">&quot;(alg,sta)&quot;</span>,<span class="st">&quot;(ana,sta)&quot;</span>),</a>
<a class="sourceLine" id="cb64-5" title="5">                                    <span class="st">&quot;cor from sample&quot;</span> =<span class="st"> </span>real,</a>
<a class="sourceLine" id="cb64-6" title="6">                                <span class="st">&quot;estimated cor from bootstrap&quot;</span> =<span class="st"> </span>mean,</a>
<a class="sourceLine" id="cb64-7" title="7">                                  <span class="st">&quot;standard error&quot;</span> =<span class="st"> </span>standard.error</a>
<a class="sourceLine" id="cb64-8" title="8">                                    )</a>
<a class="sourceLine" id="cb64-9" title="9">knitr<span class="op">::</span><span class="kw">kable</span>(standard.error.matrix)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">subjects</th>
<th align="right">cor.from.sample</th>
<th align="right">estimated.cor.from.bootstrap</th>
<th align="right">standard.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(mec,vec)</td>
<td align="right">0.5534052</td>
<td align="right">0.5461752</td>
<td align="right">0.0788201</td>
</tr>
<tr class="even">
<td align="left">(alg,ana)</td>
<td align="right">0.7108059</td>
<td align="right">0.7099956</td>
<td align="right">0.0477697</td>
</tr>
<tr class="odd">
<td align="left">(alg,sta)</td>
<td align="right">0.6647357</td>
<td align="right">0.6648414</td>
<td align="right">0.0613319</td>
</tr>
<tr class="even">
<td align="left">(ana,sta)</td>
<td align="right">0.6071743</td>
<td align="right">0.6097153</td>
<td align="right">0.0587168</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2-3" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness)</li>
</ul>
</div>
<div id="answer-2-3" class="section level3">
<h3>Answer 2</h3>
<p>As we know,the skewness of the normal population is 0, and the skewness of <span class="math inline">\(\chi^{2}(5)\)</span> is <span class="math inline">\(\sqrt{\frac{8}{5}}\)</span>. First of all, we give a function to calculate skewness.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">skewness &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb65-2" title="2">  <span class="co">#compute the sample skewness</span></a>
<a class="sourceLine" id="cb65-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb65-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb65-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb65-7" title="7">}</a></code></pre></div>
<p>First, we check the normal populations.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">555</span>)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     aml</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># the skewness of normal populations</span></a>
<a class="sourceLine" id="cb69-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># the sample size in bootstrap</span></a>
<a class="sourceLine" id="cb69-3" title="3">m &lt;-<span class="st"> </span><span class="fl">1e3</span> <span class="co"># replicate time in Monte Carlo experiments</span></a>
<a class="sourceLine" id="cb69-4" title="4">boot.skew &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">skewness</span>(x[i])</a>
<a class="sourceLine" id="cb69-5" title="5">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb69-7" title="7">  X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb69-8" title="8">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> X, <span class="dt">statistic =</span> boot.skew, <span class="dt">R =</span> <span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb69-9" title="9">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb69-10" title="10">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb69-11" title="11">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb69-12" title="12">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb69-13" title="13">}</a></code></pre></div>
<p>Let’s show it in the table.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">cover.prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-2" title="2">                <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-3" title="3">                <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb70-4" title="4">left.omit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-5" title="5">               <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-6" title="6">               <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb70-7" title="7">right.omit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-8" title="8">               <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb70-9" title="9">               <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb70-10" title="10">cover.norm &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(cover.prob,left.omit,right.omit),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>,)</a>
<a class="sourceLine" id="cb70-11" title="11"><span class="kw">rownames</span>(cover.norm) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cover probability&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>)</a>
<a class="sourceLine" id="cb70-12" title="12"><span class="kw">colnames</span>(cover.norm) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;standard normal bootstrap confidence interval&quot;</span>,<span class="st">&quot;basic bootstrap confidence interval&quot;</span>,<span class="st">&quot;percentile bootstrap confidence interval&quot;</span>)</a>
<a class="sourceLine" id="cb70-13" title="13">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">t</span>(cover.norm))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">cover probability</th>
<th align="right">miss on the left</th>
<th align="right">miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>standard normal bootstrap confidence interval</td>
<td align="right">0.895</td>
<td align="right">0.051</td>
<td align="right">0.054</td>
</tr>
<tr class="even">
<td>basic bootstrap confidence interval</td>
<td align="right">0.885</td>
<td align="right">0.057</td>
<td align="right">0.058</td>
</tr>
<tr class="odd">
<td>percentile bootstrap confidence interval</td>
<td align="right">0.972</td>
<td align="right">0.016</td>
<td align="right">0.012</td>
</tr>
</tbody>
</table>
<p>Then we check the chi-squared distributions.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">555</span>)</a>
<a class="sourceLine" id="cb71-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)  <span class="co"># the skewness of chi-squared distribution</span></a>
<a class="sourceLine" id="cb71-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># the sample size in bootstrap</span></a>
<a class="sourceLine" id="cb71-4" title="4">m &lt;-<span class="st"> </span><span class="fl">1e3</span> <span class="co"># replicate time in Monte Carlo experiments</span></a>
<a class="sourceLine" id="cb71-5" title="5">boot.skew &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">skewness</span>(x[i])</a>
<a class="sourceLine" id="cb71-6" title="6">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb71-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb71-8" title="8">  X &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb71-9" title="9">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> X, <span class="dt">statistic =</span> boot.skew, <span class="dt">R =</span> <span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb71-10" title="10">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb71-11" title="11">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb71-12" title="12">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb71-13" title="13">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb71-14" title="14">}</a></code></pre></div>
<p>Again, we show it in a table.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">cover.prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-2" title="2">                <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-3" title="3">                <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb72-4" title="4">left.omit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-5" title="5">               <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-6" title="6">               <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb72-7" title="7">right.omit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-8" title="8">               <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu),</a>
<a class="sourceLine" id="cb72-9" title="9">               <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span><span class="st"> </span>mu))</a>
<a class="sourceLine" id="cb72-10" title="10">cover.chisq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(cover.prob,left.omit,right.omit),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>,)</a>
<a class="sourceLine" id="cb72-11" title="11"><span class="kw">rownames</span>(cover.chisq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cover probability&quot;</span>,<span class="st">&quot;miss on the left&quot;</span>,<span class="st">&quot;miss on the right&quot;</span>)</a>
<a class="sourceLine" id="cb72-12" title="12"><span class="kw">colnames</span>(cover.chisq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;standard normal bootstrap confidence interval&quot;</span>,<span class="st">&quot;basic bootstrap confidence interval&quot;</span>,<span class="st">&quot;percentile bootstrap confidence interval&quot;</span>)</a>
<a class="sourceLine" id="cb72-13" title="13">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">t</span>(cover.chisq))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">cover probability</th>
<th align="right">miss on the left</th>
<th align="right">miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>standard normal bootstrap confidence interval</td>
<td align="right">0.723</td>
<td align="right">0.019</td>
<td align="right">0.258</td>
</tr>
<tr class="even">
<td>basic bootstrap confidence interval</td>
<td align="right">0.702</td>
<td align="right">0.030</td>
<td align="right">0.268</td>
</tr>
<tr class="odd">
<td>percentile bootstrap confidence interval</td>
<td align="right">0.695</td>
<td align="right">0.000</td>
<td align="right">0.305</td>
</tr>
</tbody>
</table>
<p><strong>We can see that the confidence interval mostly miss on the right in the chi-squared condition.</strong> ## HW7:2019-11-15</p>
</div>
<div id="question-1-4" class="section level3">
<h3>Question 1</h3>
<ul>
<li>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</li>
</ul>
</div>
<div id="answer-1-4" class="section level3">
<h3>Answer 1</h3>
<p>From the textbook, we know that the jack-knife estimate of bias is<span class="math display">\[
\widehat{\operatorname{bias}_{j a c k}}=(n-1)(\overline{\hat{\theta}_{(\cdot)}}-\hat{\theta})\]</span>where <span class="math inline">\(\overline{\hat{\theta}_{(\cdot)}}=\frac{1}{n} \sum_{i=1}^{n} \hat{\theta}_{(i)}\)</span> is the mean of the estimates from the leave-one-out samples, and <span class="math inline">\(\hat{\theta}=\hat{\theta}(x)\)</span> is the estimate computed from the original observed sample. A jackknife estimate of standard error is <span class="math display">\[
\widehat{s e}_{j a c k}=\sqrt{\frac{n-1}{n} \sum_{i=1}^{n}\left(\hat{\theta}_{(i)}-\widehat{\theta}_{(\cdot)}\right)^{2}}\]</span> In this question, we want to estimate the statistics <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}\]</span> Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma},\)</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.</p>
<p>First, we write a function to get the MLE of covariance matrix.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">cov.mle &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb73-2" title="2">  a &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(a)</a>
<a class="sourceLine" id="cb73-3" title="3">  k &lt;-<span class="st"> </span><span class="kw">ncol</span>(a)</a>
<a class="sourceLine" id="cb73-4" title="4">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb73-5" title="5">    a[,i] &lt;-<span class="st"> </span>a[,i] <span class="op">-</span><span class="st"> </span><span class="kw">colMeans</span>(a)[i]</a>
<a class="sourceLine" id="cb73-6" title="6">  }</a>
<a class="sourceLine" id="cb73-7" title="7">  <span class="kw">t</span>(a) <span class="op">%*%</span><span class="st"> </span>a <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(a)</a>
<a class="sourceLine" id="cb73-8" title="8">}</a></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb74-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb74-3" title="3">eigen.value &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov.mle</span>(scor))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb74-4" title="4">lamda.hat &lt;-<span class="st"> </span><span class="kw">max</span>(eigen.value)<span class="op">/</span><span class="kw">sum</span>(eigen.value)</a>
<a class="sourceLine" id="cb74-5" title="5">lamda.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="co"># resampling using jackknife method</span></a>
<a class="sourceLine" id="cb74-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb74-8" title="8">  scor.jacknife &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb74-9" title="9">  eigen.value &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov.mle</span>(scor.jacknife))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb74-10" title="10">  lamda.jack[i] &lt;-<span class="st"> </span><span class="kw">max</span>(eigen.value)<span class="op">/</span><span class="kw">sum</span>(eigen.value)</a>
<a class="sourceLine" id="cb74-11" title="11">}</a>
<a class="sourceLine" id="cb74-12" title="12">bias &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(lamda.jack)<span class="op">-</span>lamda.hat)</a>
<a class="sourceLine" id="cb74-13" title="13">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((lamda.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(lamda.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb74-14" title="14">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="st">&quot;estimate of bias&quot;</span>=bias,<span class="st">&quot;estimate of standard error&quot;</span>=se))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">estimate.of.bias</th>
<th align="right">estimate.of.standard.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0010691</td>
<td align="right">0.0495523</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2-4" class="section level3">
<h3>Question 2</h3>
<ul>
<li>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</li>
</ul>
</div>
<div id="answer-2-4" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">library</span>(DAAG);<span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     lung</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb81-2" title="2">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb81-3" title="3">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb81-4" title="4">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkNtmtrZmtttmtv+QOgCQOjqQttuQ2/+2ZgC225C227a229u22/+2///bkDrbtmbb2//b////tmb/25D/27b//7b//9v///9xEpnGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALLklEQVR4nO2dC5vbphKGlW2z7jXpupdzmm2jtlm1kWv7//+8ChC6GeYDBAiv5nuebLTSeEDvwoCkMaquLFLV1hUoXQwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAioJ0OXvb6qq+u7Tcn9dPbxok+fq7eeslSoI0PmnSulpcYABSXXnrvVhfmQCKL/KAdRU1Ze/X6//dpy6RqKgnI+iOXXbf/5cVe8+jS1IdMYvfs1RrWIAdaeu2snlt/f/XBeAlLo9PaDa3BdTqBhAHYvHya8LQG8/Xf+uOgMFqK2qHz7/e8zS84oBdDrMGsQc0JuP/S4FSB1s3v2VoV73AUg2labjJAFlHcqKAWTsYoparXhMAT3a3ERXMYAmQVoMV3NA3IKuy2G+kXGnrfogLWZGyxjUfvd7hmqVA2g+UWwEGgFLAXpYjmLvRTtazihTqBxA46XG+6vsXMNcxzoPyhGJCgKkL1bV4H3qcL37k5xJ/y9HpUoCVKQYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAvIDpDMwNkzLzS0vQI3OkmuzJJgWIR9Al+cBS5M53307+QA6H4eEpXY3nSxyC6ruRikAdTGob0LWGFT+oNizSQNI5OpKWSNQ8YB060kEKLe76Br6V2ZA/l17I+laJopBvU4Ha/rtvgHpCCRkGeZLB3TVfNK0oH7wuuMWpEaxZMN814bE+HXXgK49I2djT+f1m4+vAFDKUay7YL1zQKmH+dPhi7sGlH6ieHm2f8vmLgDJn87mkUuP6y6B0l6L5XYXX3qA3wsg34ubwX4ngLwv/wbrfQDyvkCuGBCyHzadP+NZp7zuUGnegMZN58/4VSmzO1hcaAPaCyCvUWxmy3cUbzSv3F5akLsqBkRq2bhDANVy0Yd1D92LiEGmnctdAYBq+bDrfFy13kMJo5hp580ef0D6wfu6p+4FzINMOw3EnMvQG/rBe/MKAZmamXMZw5Z68H46rApCGwGaTQFvABljknMZ46ZckUYupxaubWLQnIgLn1TDPEzB22QUW7aZmw5m+qBzCT7VwSl4m8yD6Em8+UgSQC4JVB7uookEZDngCeh8fBoevNtHMYcUvG1m0v589tWCiIt6+wFn13rj/KMav6iJ4p2l4JGRydmJ3tCAyIniXaXgkbdffAHplfiqlWsQFwQIjG3ObvSGbkFrKlPUDbPYgNzVEvPtVw2oCzBvP9dkD+t64tPp+8/TAT+w3OQCLToAUPvmYzd4dzMiu7G4ZVTL1lPYMH+rCmQiht3uEKdNjGKy3Zy+EoBKmSjaLkuJS7N+p3MJekOcvQBEzINU67r8cy2mBdku46mL+36vcxF6Q7egmvii09C6rB1xyxtm07tD1O0htdu5jGFLxaCGXKO5UcNXazUqBJDVZtztXMa4KafJd3XDzAhogSMioBjaPgbdwIgVg+Jo81HM1Fgi3XKN8o3mTedBPhc7AYDqGF9D3RKQ19VgyDwoxje9XzWgGO9gyAbIHGvmgGJfasR4CUMuQLbRasEn7sVqjNd4ZAJkne5MdtI9LqSLVeGjmHGKllDG3pQYUBxtA0htM6BpObd8boJO5Bg0+cbuili0xSg2bi6AxB3F+mddXaheMyNKAYiObIGBL3yYF7c8wte+SQCI7imh40L4RLF9eFmRhRcfEBlrw8fNsDuKQqIF5QOET3AAdDPvWYFnXQxaM6f2rLDD1EkDmpuunnUF31HsGg9xWR85w8zpNCd8bu+uBivNPCh2hpnbeRpmgYUCip4ftDxPYh4zNR0mbC4xzFa0v6GeKebMMDMEFniwmvPJNsyLB2LNI7UuR4oMMyLwmpvXLCKt6GlhdxRb8eiZenAYL8PMcF4A0LjvagPkAStsonj6+kX+sypahpnpLw8BjUTMgHyaU9hEUSRRkYBilWvsG7iLLQgZLuqdCQU0NTF/rp/CFiH1jQfegBZ9a+hNBoKONXAzmxnWj6ILkZcZTdXfDLFdjUQBVI3heDkFoiAkB4QlchfUN+5WAjKHi0W/mXQmtzjjwSflRPHyTKRZRRjFRiKLX60fdDoWXNFhy32iWNsv+FfN/heAlrwGq8l/4YV5G8qGQWuYKNaP6QFpMOYu5tOb1lV0Ng9C0ljssXxdpQ0tZ9GCjDuDyvI2nFxH2KWn0pdnf0AOJzRpMZbJ4IaA+vTVlSIDqOvdw8U1ezGADqrUNPlB6JQMJ20MN7PWlaKiVsPEyQvEKVlbRGUasKpJmEpRUath4vSX4ZRmZ+3TXW7aUeYbZk5BekW58w7jH0pMPS3vDbPEQfp6C8YH0NJ0bU8L6WJ9cUmTOJ0Amc7ZaJoVUBzRLcgik6Hl0w47V1c00HCNuxsiFCB7s3LcuaKiawxpL1R3mR+piHvK00+YyjAWHFjj6Ib+7uzUggDF1eaA7HDGw9H7jYc2BoQbQUUM0xn4bAvIuQnk6U3moqMburtzP+l9AvI568343AugLOHGXHB0Q2d3If0mP6dEgJwyzIL45CaUBpBjhlkQn8yEkgBKtQLVqwGUag2zVwMo2RpmrygGJVrDzMwnJbVEo1jWNcyStqvNr+YjuEoamYq5YbbaZzyHc+/RDbO7Y0DQ193FoNzvWb2/Ucya9RLmbkslu1gFGQ7V3SgNIMflGVycRrKJVVSaD69xyoDy2DCgTEWl+fAapwwojw0DylRUmg+vccqA8tjcJ6DXJAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwKKDahfXYd6xVZvox5DGh8jyVTIJ9LPYEK4EWux6DelBL8wJDKg81E+Wmy76rS2KvU29m84Xp67jzbipK1+RhPii5JiHQT5abI6QHEBteqZtEpFq81/1t6GeMuSWketOz27n8GEcCMX7RWPOsnqIEUF1FZPsr5j9e021wZUuPuTU356E+RGAEJuSMWOQQoQ+Q6y/kD9bUW+cbJ+eAF+5JqhwI1Y8gi5IZUEkOrv1l4vbc5Hkcdnf2OgSINEfjoT2k0r2QE3tDYDdLO5sNEx2u6nHccue+sQq/6UB8ipi0nZ1rVUabSkn2mmLbE8pghlxXUxEBWngMyDdP+dB8pPMw08xFjf+SgvSINxdQLR/Gcdlymy+tEmhJvhUDnD/FVXlZ6Z9aOYqLAxup4Oeq/Vz2hidyNf1yjhlDNRHP6WDTW3723E+6WNoaNROWDCgc3PxMTqZnKIrA4tvlgFYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAioKED022GMR+O8UIbQHQGK9RE/MSCgQgA1Mlv+fPzloBJWGpW6ejr8/9htnORexaLp8+r71JadAFLvJ306H0Xic/9P5EidDjKh/uFFJNBJFr2lzJtS23sAJHPi9f+nwwf1e/vwIhPJ+h8fBIvB8sePKsduH4B0kqo82+6HSpfT6Zf6h3xd9ySdtR37XUKVAahPUh0A9QuxGQDpdNYuFD38sfMWdB3Z3LSg4cA+AI0xSAEazvoGkLZUCf276WJyPLo8P2pA8vdr3X/dZwpIW6rGI7+rsQtAwzxIz2zE710juQWk50EysbdDuBdA5YoBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQED/AbNtmV6hG5s5AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let have a look at the fitted regression equation:</p>
<ul>
<li><p>linear model: <span class="math inline">\(\hat{Y}=\)</span> 1.4025974 + 0.9157699<span class="math inline">\(X\)</span></p></li>
<li><p>quadratic model: <span class="math inline">\(\hat{Y}=\)</span> 24.4926234 -1.3933385<span class="math inline">\(X\)</span> + 0.054519<span class="math inline">\(X^2\)</span></p></li>
<li><p>cubic model: <span class="math inline">\(\hat{Y}=\)</span> 3.0158507 + 1.9180817<span class="math inline">\(X\)</span> -0.1079627<span class="math inline">\(X^2\)</span> + 0.0025508<span class="math inline">\(X^3\)</span></p></li>
<li><p>Exponential model: <span class="math inline">\(log\hat{Y}=\)</span> 2.112158 + 0.0416078<span class="math inline">\(X\)</span></p></li>
</ul>
<p>Now, we calculate the bias by using cross validation.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb82-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co">#for n-fold cross validation</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co">#fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb82-6" title="6">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb82-7" title="7">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb82-8" title="8">  <span class="co">#linear</span></a>
<a class="sourceLine" id="cb82-9" title="9">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb82-10" title="10">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</a>
<a class="sourceLine" id="cb82-11" title="11">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb82-12" title="12">  <span class="co">#quadratic</span></a>
<a class="sourceLine" id="cb82-13" title="13">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb82-14" title="14">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb82-15" title="15">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb82-16" title="16">  <span class="co">#cubic</span></a>
<a class="sourceLine" id="cb82-17" title="17">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb82-18" title="18">  yhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-19" title="19"><span class="st">           </span>J3<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb82-20" title="20">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb82-21" title="21">  <span class="co">#exponential</span></a>
<a class="sourceLine" id="cb82-22" title="22">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb82-23" title="23">  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</a>
<a class="sourceLine" id="cb82-24" title="24">  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb82-25" title="25">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb82-26" title="26">}</a>
<a class="sourceLine" id="cb82-27" title="27">bias &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;linear&quot;</span> =<span class="st"> </span><span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb82-28" title="28">                   <span class="st">&quot;quadratic&quot;</span> =<span class="st"> </span><span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb82-29" title="29">                   <span class="st">&quot;cubic&quot;</span> =<span class="st"> </span><span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb82-30" title="30">                   <span class="st">&quot;exponential&quot;</span> =<span class="st"> </span><span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb82-31" title="31">knitr<span class="op">::</span><span class="kw">kable</span>(bias)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">linear</th>
<th align="right">quadratic</th>
<th align="right">cubic</th>
<th align="right">exponential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">19.55644</td>
<td align="right">17.85248</td>
<td align="right">18.17756</td>
<td align="right">20.45424</td>
</tr>
</tbody>
</table>
<p><strong>According to the cross validation procedure, we should choose the quadratic model. </strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">R.squared &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;linear&quot;</span> =<span class="st"> </span><span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.sq,</a>
<a class="sourceLine" id="cb83-2" title="2">               <span class="st">&quot;quadratic&quot;</span> =<span class="st"> </span><span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.sq,</a>
<a class="sourceLine" id="cb83-3" title="3">               <span class="st">&quot;cubic&quot;</span> =<span class="st"> </span><span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.sq,</a>
<a class="sourceLine" id="cb83-4" title="4">               <span class="st">&quot;exponential&quot;</span> =<span class="st"> </span><span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.sq)</a>
<a class="sourceLine" id="cb83-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(R.squared)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">linear</th>
<th align="right">quadratic</th>
<th align="right">cubic</th>
<th align="right">exponential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5281545</td>
<td align="right">0.5768151</td>
<td align="right">0.5740396</td>
<td align="right">0.5280556</td>
</tr>
</tbody>
</table>
<p><strong>According to the R-squared, we should choose the quadratic model. </strong> ## HW8:2019-11-22</p>
</div>
<div id="question-1-5" class="section level3">
<h3>Question 1</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-1-5" class="section level3">
<h3>Answer 1</h3>
<p>The hypothesis test is: <span class="math display">\[H_0:VarX = VarY\longleftrightarrow H_1:VarX \neq VarY\]</span> First, we write a function to calculate the extreme points.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">count_extreme_points &lt;-<span class="st"> </span><span class="cf">function</span>(sample1,sample2){</a>
<a class="sourceLine" id="cb84-2" title="2">  x &lt;-<span class="st"> </span>sample1;y &lt;-<span class="st"> </span>sample2</a>
<a class="sourceLine" id="cb84-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb84-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb84-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb84-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb84-7" title="7">  <span class="kw">max</span>(outx,outy)</a>
<a class="sourceLine" id="cb84-8" title="8">} </a></code></pre></div>
<p>We implement a permutation test for equal variance based on the maximum number of extreme points following the steps below.</p>
<ol style="list-style-type: decimal">
<li><p>Compute the observed test statistic (i.e. extreme points) <span class="math inline">\(\hat{\theta}(X, Y)=\hat{\theta}(Z, \nu)\)</span>.</p></li>
<li><p>For each replicate, indexed b = 1, . . ., B:</p>
<ul>
<li>Generate a random permutation <span class="math inline">\(\pi_{b}=\pi(\nu)\)</span>.</li>
<li>Compute the statistic <span class="math inline">\(\hat{\theta}^{(b)}=\hat{\theta}^{*}\left(Z, \pi_{b}\right)\)</span>.</li>
</ul></li>
<li><p>The large values of <span class="math inline">\(\hat{\theta}\)</span> support the alternative, compute the empirical p-value by</p></li>
</ol>
<p><span class="math display">\[
\hat{p}=\frac{1+\#\left\{\hat{\theta}^{(b)} \geq \hat{\theta}\right\}}{B+1}=\frac{\left\{1+\sum_{b=1}^{B} I\left(\hat{\theta}^{(b)} \geq \hat{\theta}\right)\right\}}{B+1}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Reject <span class="math inline">\(H_0\)</span> at significance level <span class="math inline">\(\alpha\)</span> if <span class="math inline">\(\hat{p} \leq \alpha\)</span>.</li>
</ol>
<p>We estimate the type1 error based on 1000 Monte Carlo experiments, and we set the significance level at 0.05</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>    <span class="co">#significance level</span></a>
<a class="sourceLine" id="cb85-2" title="2">n1 &lt;-<span class="st"> </span><span class="dv">30</span>;n2 &lt;-<span class="dv">50</span> <span class="co">#two different sample size</span></a>
<a class="sourceLine" id="cb85-3" title="3">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>;sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb85-4" title="4">m &lt;-<span class="st"> </span><span class="dv">1000</span>   <span class="co"># the times of Monte Carlo experiments</span></a>
<a class="sourceLine" id="cb85-5" title="5"></a>
<a class="sourceLine" id="cb85-6" title="6">p_value &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb85-7" title="7">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</a>
<a class="sourceLine" id="cb85-8" title="8">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</a>
<a class="sourceLine" id="cb85-9" title="9">  ts &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">199</span><span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb85-10" title="10">  ts[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">count_extreme_points</span>(x1,x2)</a>
<a class="sourceLine" id="cb85-11" title="11">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">199</span>){</a>
<a class="sourceLine" id="cb85-12" title="12">    ind &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2),<span class="dt">size =</span> n1,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb85-13" title="13">    x.perm &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)[ind]; y.perm &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)[<span class="op">-</span>ind]</a>
<a class="sourceLine" id="cb85-14" title="14">    ts[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">count_extreme_points</span>(x.perm,y.perm)</a>
<a class="sourceLine" id="cb85-15" title="15">  }</a>
<a class="sourceLine" id="cb85-16" title="16">  <span class="kw">mean</span>(ts <span class="op">&gt;=</span><span class="st"> </span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb85-17" title="17">})</a>
<a class="sourceLine" id="cb85-18" title="18"><span class="co">#estimate the type1 error</span></a>
<a class="sourceLine" id="cb85-19" title="19"><span class="kw">print</span>(<span class="kw">mean</span>(p_value <span class="op">&lt;</span><span class="st"> </span>alpha))</a></code></pre></div>
<pre><code>## [1] 0.037</code></pre>
<p><strong>As a result, we can see that the permutation method control the type1 error quite well.</strong></p>
</div>
<div id="question-2-5" class="section level3">
<h3>Question 2</h3>
<p>Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model 1:<span class="math inline">\(Y=X/4+e\)</span></p>
<p>Model 2:<span class="math inline">\(Y=X/4×e\)</span></p>
<p><span class="math inline">\(I∼N(0_2,I_2),e∼N(0_2,I_2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
</div>
<div id="answer-2-5" class="section level3">
<h3>Answer 2</h3>
<p>The hypothesis test is: <span class="math display">\[H_0:F_{XY} = F_XF_Y\longleftrightarrow H_1:F_{XY} \neq F_XF_Y\]</span> Here we give the function to implement the calculation of distance correlation.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">library</span>(MASS);<span class="kw">library</span>(boot);<span class="kw">library</span>(Ball)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">dCov &lt;-<span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb90-2" title="2">  x &lt;-<span class="kw">as.matrix</span>(x);y &lt;-<span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb90-3" title="3">  n &lt;-<span class="kw">nrow</span>(x); m &lt;-<span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb90-4" title="4">  <span class="cf">if</span>(n<span class="op">!=</span>m<span class="op">||</span>n<span class="op">&lt;</span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb90-5" title="5">  <span class="cf">if</span>(<span class="op">!</span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb90-6" title="6">    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb90-7" title="7">  Akl &lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb90-8" title="8">    d &lt;-<span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb90-9" title="9">    m &lt;-<span class="kw">rowMeans</span>(d); </a>
<a class="sourceLine" id="cb90-10" title="10">    M &lt;-<span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb90-11" title="11">    a &lt;-<span class="kw">sweep</span>(d, <span class="dv">1</span>, m);</a>
<a class="sourceLine" id="cb90-12" title="12">    b &lt;-<span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb90-13" title="13">    <span class="kw">return</span>(b<span class="op">+</span>M)</a>
<a class="sourceLine" id="cb90-14" title="14">  }</a>
<a class="sourceLine" id="cb90-15" title="15">  A &lt;-<span class="kw">Akl</span>(x); </a>
<a class="sourceLine" id="cb90-16" title="16">  B &lt;-<span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb90-17" title="17">  <span class="kw">sqrt</span>(<span class="kw">mean</span>(A<span class="op">*</span>B))</a>
<a class="sourceLine" id="cb90-18" title="18">}</a>
<a class="sourceLine" id="cb90-19" title="19"></a>
<a class="sourceLine" id="cb90-20" title="20">ndCov2 &lt;-<span class="cf">function</span>(z, ix, dims) {<span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb90-21" title="21">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-22" title="22">  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-23" title="23">  d &lt;-<span class="st"> </span>p<span class="op">+</span>q</a>
<a class="sourceLine" id="cb90-24" title="24">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p]<span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb90-25" title="25">  y &lt;-<span class="st"> </span>z[ix,<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)]<span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb90-26" title="26">  <span class="kw">return</span>(<span class="kw">nrow</span>(z)<span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-27" title="27">  }</a></code></pre></div>
<p>(Sorry for the limited calculation ability of my computer, I set some parameters <code>m</code>,<code>R</code> to a low amount)</p>
<p>Now we calculate the empirical power of Model 1:<span class="math inline">\(Y=X/4+e\)</span>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">100</span>,<span class="dv">120</span>,<span class="dv">150</span>,<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb91-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="co">#significance level</span></a>
<a class="sourceLine" id="cb91-3" title="3">m &lt;-<span class="st"> </span><span class="dv">200</span> <span class="co"># Monte Carlo times</span></a>
<a class="sourceLine" id="cb91-4" title="4">powers1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">ncol =</span> <span class="kw">length</span>(n)))</a>
<a class="sourceLine" id="cb91-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb91-6" title="6">  p.cor &lt;-<span class="st"> </span><span class="kw">numeric</span>(m);p.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb91-7" title="7">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb91-8" title="8">    mu =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>); sigma =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb91-9" title="9">    x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma); e &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma)</a>
<a class="sourceLine" id="cb91-10" title="10">    y1 &lt;-<span class="st"> </span>x1<span class="op">/</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb91-11" title="11">    z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(x1,y1),<span class="dt">nrow =</span> n[i])</a>
<a class="sourceLine" id="cb91-12" title="12">    <span class="co"># permutation: resampling without replacement</span></a>
<a class="sourceLine" id="cb91-13" title="13">    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,</a>
<a class="sourceLine" id="cb91-14" title="14">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb91-15" title="15">    tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb91-16" title="16">    p.cor[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb91-17" title="17">    p.ball[j] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">seed =</span> j)<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb91-18" title="18">  }</a>
<a class="sourceLine" id="cb91-19" title="19">  powers.cor &lt;-<span class="st"> </span><span class="kw">mean</span>(p.cor <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb91-20" title="20">  powers.ball &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb91-21" title="21">  powers1[,i] &lt;-<span class="st"> </span><span class="kw">c</span>(powers.cor,powers.ball)</a>
<a class="sourceLine" id="cb91-22" title="22">}</a></code></pre></div>
<p>We show the results in a table.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">rownames</span>(powers1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;distance correlation test&quot;</span>,<span class="st">&quot;ball covariance test&quot;</span>)</a>
<a class="sourceLine" id="cb92-2" title="2">name.str &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb92-4" title="4">  name.str &lt;-<span class="st"> </span><span class="kw">c</span>(name.str,<span class="kw">paste</span>(<span class="st">&quot;n is&quot;</span>,n[i]))</a>
<a class="sourceLine" id="cb92-5" title="5">}</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">colnames</span>(powers1) &lt;-<span class="st"> </span>name.str</a>
<a class="sourceLine" id="cb92-7" title="7">knitr<span class="op">::</span><span class="kw">kable</span>(powers1)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">n is 30</th>
<th align="right">n is 50</th>
<th align="right">n is 80</th>
<th align="right">n is 100</th>
<th align="right">n is 120</th>
<th align="right">n is 150</th>
<th align="right">n is 200</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>distance correlation test</td>
<td align="right">0.375</td>
<td align="right">0.560</td>
<td align="right">0.755</td>
<td align="right">0.835</td>
<td align="right">0.895</td>
<td align="right">0.960</td>
<td align="right">0.990</td>
</tr>
<tr class="even">
<td>ball covariance test</td>
<td align="right">0.260</td>
<td align="right">0.335</td>
<td align="right">0.520</td>
<td align="right">0.540</td>
<td align="right">0.675</td>
<td align="right">0.825</td>
<td align="right">0.905</td>
</tr>
</tbody>
</table>
<p>Now we calculate the empirical power of Model 2:<span class="math inline">\(Y=X/4*e\)</span>:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">powers2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">ncol =</span> <span class="kw">length</span>(n)))</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb93-3" title="3">  p.cor &lt;-<span class="st"> </span><span class="kw">numeric</span>(m);p.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb93-4" title="4">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-5" title="5">    mu =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>); sigma =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-6" title="6">    x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma); e &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma)</a>
<a class="sourceLine" id="cb93-7" title="7">    y1 &lt;-<span class="st"> </span>x1<span class="op">/</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb93-8" title="8">    z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(x1,y1),<span class="dt">nrow =</span> n[i])</a>
<a class="sourceLine" id="cb93-9" title="9">    <span class="co"># permutation: resampling without replacement</span></a>
<a class="sourceLine" id="cb93-10" title="10">    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,</a>
<a class="sourceLine" id="cb93-11" title="11">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-12" title="12">    tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb93-13" title="13">    p.cor[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb93-14" title="14">    p.ball[j] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">bcov.test</span>(z[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R =</span> <span class="dv">99</span>,<span class="dt">seed =</span> j)<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb93-15" title="15">  }</a>
<a class="sourceLine" id="cb93-16" title="16">  powers.cor &lt;-<span class="st"> </span><span class="kw">mean</span>(p.cor <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb93-17" title="17">  powers.ball &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb93-18" title="18">  powers2[,i] &lt;-<span class="st"> </span><span class="kw">c</span>(powers.cor,powers.ball)</a>
<a class="sourceLine" id="cb93-19" title="19">}</a></code></pre></div>
<p>Again, we show the results in a table.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">rownames</span>(powers2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;distance correlation test&quot;</span>,<span class="st">&quot;ball covariance test&quot;</span>)</a>
<a class="sourceLine" id="cb94-2" title="2">name.str &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb94-4" title="4">  name.str &lt;-<span class="st"> </span><span class="kw">c</span>(name.str,<span class="kw">paste</span>(<span class="st">&quot;n is&quot;</span>,n[i]))</a>
<a class="sourceLine" id="cb94-5" title="5">}</a>
<a class="sourceLine" id="cb94-6" title="6"><span class="kw">colnames</span>(powers2) &lt;-<span class="st"> </span>name.str</a>
<a class="sourceLine" id="cb94-7" title="7">knitr<span class="op">::</span><span class="kw">kable</span>(powers2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">n is 30</th>
<th align="right">n is 50</th>
<th align="right">n is 80</th>
<th align="right">n is 100</th>
<th align="right">n is 120</th>
<th align="right">n is 150</th>
<th align="right">n is 200</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>distance correlation test</td>
<td align="right">0.575</td>
<td align="right">0.73</td>
<td align="right">0.83</td>
<td align="right">0.92</td>
<td align="right">0.96</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>ball covariance test</td>
<td align="right">0.900</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Now we draw the curve of estimated empirical power to compare two methods.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">plot</span>(n,<span class="kw">as.vector</span>(powers1[<span class="dv">1</span>,]),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">210</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab =</span> <span class="st">&quot;sample size&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;power comparision in model 1&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb95-3" title="3"><span class="kw">lines</span>(n,<span class="kw">as.vector</span>(powers1[<span class="dv">2</span>,]),<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;distance correlation&quot;</span>,<span class="st">&quot;ball covariance&quot;</span>))</a>
<a class="sourceLine" id="cb95-5" title="5"><span class="kw">plot</span>(n,<span class="kw">as.vector</span>(powers2[<span class="dv">1</span>,]),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">210</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab =</span> <span class="st">&quot;sample size&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;power comparision in model 2&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb95-6" title="6"><span class="kw">lines</span>(n,<span class="kw">as.vector</span>(powers2[<span class="dv">2</span>,]),<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb95-7" title="7"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;distance correlation&quot;</span>,<span class="st">&quot;ball covariance&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>As we can see, distance correlation have better performance in the linear model 1, while ball covariance test have better performance in the non-linear model 2.</strong></p>
</div>
</div>
<div id="hw92019-11-29" class="section level2">
<h2>HW9:2019-11-29</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>The standard Laplace distribution is <span class="math inline">\(\frac{1}{2}e^{-|x|}\)</span>, so <span class="math display">\[r(x_t,y)=\frac{f(Y)}{f(X_t)}=e^{|x_t|-|y|}\]</span></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">r &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</a>
<a class="sourceLine" id="cb96-2" title="2">  <span class="kw">exp</span>(<span class="kw">abs</span>(x)<span class="op">-</span><span class="kw">abs</span>(y))</a>
<a class="sourceLine" id="cb96-3" title="3">}</a></code></pre></div>
<p>Now we write a function to implement the random walk Metropolis sampler to generate the standard Laplace distribution</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(x0,sigma,N) {</a>
<a class="sourceLine" id="cb97-2" title="2">  <span class="co">#x0: the initial point</span></a>
<a class="sourceLine" id="cb97-3" title="3">  <span class="co">#sigma: the standard deviation in the normal distribution</span></a>
<a class="sourceLine" id="cb97-4" title="4">  <span class="co">#N: the length of the chain</span></a>
<a class="sourceLine" id="cb97-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb97-6" title="6">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb97-7" title="7">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb97-8" title="8">  accept &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#count reject</span></a>
<a class="sourceLine" id="cb97-9" title="9">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb97-10" title="10">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</a>
<a class="sourceLine" id="cb97-11" title="11">    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">r</span>(x[i<span class="dv">-1</span>],y)){</a>
<a class="sourceLine" id="cb97-12" title="12">       x[i] &lt;-<span class="st"> </span>y;accept &lt;-<span class="st"> </span>accept <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb97-13" title="13">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb97-14" title="14">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb97-15" title="15">    }</a>
<a class="sourceLine" id="cb97-16" title="16">  }</a>
<a class="sourceLine" id="cb97-17" title="17">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x,<span class="dt">accept =</span> accept))</a>
<a class="sourceLine" id="cb97-18" title="18">}</a></code></pre></div>
<p>Then we generate the chain under different sigma in the proposed distribution</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">N &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb98-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb98-3" title="3">x0 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb98-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb98-5" title="5">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;rw&quot;</span>,i),<span class="kw">rw.Metropolis</span>(x0,sigma[i],N))  </a>
<a class="sourceLine" id="cb98-6" title="6">}</a></code></pre></div>
<p>We plot the chains under different sigma</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># quantile for laplace distribution(0.025,0.975)</span></a>
<a class="sourceLine" id="cb99-2" title="2">quantile &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span>),<span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb99-3" title="3">index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb99-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb99-5" title="5">  <span class="kw">plot</span>(index,<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;rw&quot;</span>,i))<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb99-6" title="6">       <span class="dt">main =</span> <span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])))</a>
<a class="sourceLine" id="cb99-7" title="7">  <span class="kw">abline</span>(<span class="dt">h =</span> quantile,<span class="dt">col =</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb99-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see the first chain with <span class="math inline">\(\sigma = 0.05\)</span> doesn’t converge at 2000 times.</p>
<p>Here we compute the accpetance rate:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">1</span>,<span class="dt">ncol =</span> <span class="kw">length</span>(sigma))</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">rownames</span>(a) &lt;-<span class="st"> &quot;accpetance rate&quot;</span></a>
<a class="sourceLine" id="cb100-3" title="3">col_name &lt;-<span class="st"> </span><span class="kw">character</span>(<span class="kw">length</span>(sigma))</a>
<a class="sourceLine" id="cb100-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb100-5" title="5">  col_name[i] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[i])</a>
<a class="sourceLine" id="cb100-6" title="6">  a[<span class="dv">1</span>,i] &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;rw&quot;</span>,i))<span class="op">$</span>accept <span class="op">/</span><span class="st"> </span>N</a>
<a class="sourceLine" id="cb100-7" title="7">}</a>
<a class="sourceLine" id="cb100-8" title="8"><span class="kw">colnames</span>(a) &lt;-<span class="st"> </span>col_name</a>
<a class="sourceLine" id="cb100-9" title="9">knitr<span class="op">::</span><span class="kw">kable</span>(a)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma = 0.05</th>
<th align="right">sigma = 0.5</th>
<th align="right">sigma = 2</th>
<th align="right">sigma = 4</th>
<th align="right">sigma = 8</th>
<th align="right">sigma = 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>accpetance rate</td>
<td align="right">0.9802</td>
<td align="right">0.8268</td>
<td align="right">0.5332</td>
<td align="right">0.3428</td>
<td align="right">0.1926</td>
<td align="right">0.1078</td>
</tr>
</tbody>
</table>
<p><strong>As the sigma increases, the accpetance rate goes down, but the convergence speed becomes faster.</strong></p>
<p>Calculate the quantiles for standard Laplace distribution, and compare with the chain without the first 500 values.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.45</span>)</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co"># quantile for laplace distribution(0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,0.95)</span></a>
<a class="sourceLine" id="cb101-3" title="3">q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">rev</span>(a)),<span class="dv">0</span>,<span class="op">-</span><span class="kw">log</span>(<span class="dv">1-2</span><span class="op">*</span>a))</a>
<a class="sourceLine" id="cb101-4" title="4">a1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rev</span>(<span class="fl">0.5</span><span class="op">-</span>a),<span class="fl">0.5</span>,<span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>a)</a>
<a class="sourceLine" id="cb101-5" title="5">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x,rw2<span class="op">$</span>x,rw3<span class="op">$</span>x,rw4<span class="op">$</span>x,rw5<span class="op">$</span>x,rw6<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb101-6" title="6">mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N,]</a>
<a class="sourceLine" id="cb101-7" title="7"><span class="co"># quantiles of generated chain</span></a>
<a class="sourceLine" id="cb101-8" title="8">Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">quantile</span>(x,a1))</a>
<a class="sourceLine" id="cb101-9" title="9">b &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">cbind</span>(q,Qrw),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb101-10" title="10"><span class="kw">colnames</span>(b) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;quantile&quot;</span>,col_name)</a>
<a class="sourceLine" id="cb101-11" title="11">knitr<span class="op">::</span><span class="kw">kable</span>(b)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">quantile</th>
<th align="right">sigma = 0.05</th>
<th align="right">sigma = 0.5</th>
<th align="right">sigma = 2</th>
<th align="right">sigma = 4</th>
<th align="right">sigma = 8</th>
<th align="right">sigma = 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5%</td>
<td align="right">-2.303</td>
<td align="right">15.208</td>
<td align="right">-2.053</td>
<td align="right">-2.118</td>
<td align="right">-2.293</td>
<td align="right">-2.194</td>
<td align="right">-2.607</td>
</tr>
<tr class="even">
<td>10%</td>
<td align="right">-1.609</td>
<td align="right">15.540</td>
<td align="right">-1.431</td>
<td align="right">-1.565</td>
<td align="right">-1.716</td>
<td align="right">-1.477</td>
<td align="right">-2.085</td>
</tr>
<tr class="odd">
<td>20%</td>
<td align="right">-0.916</td>
<td align="right">15.848</td>
<td align="right">-0.771</td>
<td align="right">-0.908</td>
<td align="right">-0.999</td>
<td align="right">-0.920</td>
<td align="right">-1.197</td>
</tr>
<tr class="even">
<td>30%</td>
<td align="right">-0.511</td>
<td align="right">16.030</td>
<td align="right">-0.400</td>
<td align="right">-0.468</td>
<td align="right">-0.583</td>
<td align="right">-0.509</td>
<td align="right">-0.741</td>
</tr>
<tr class="odd">
<td>40%</td>
<td align="right">-0.223</td>
<td align="right">16.186</td>
<td align="right">-0.120</td>
<td align="right">-0.181</td>
<td align="right">-0.242</td>
<td align="right">-0.212</td>
<td align="right">-0.221</td>
</tr>
<tr class="even">
<td>50%</td>
<td align="right">0.000</td>
<td align="right">16.372</td>
<td align="right">0.115</td>
<td align="right">0.045</td>
<td align="right">-0.032</td>
<td align="right">0.027</td>
<td align="right">-0.023</td>
</tr>
<tr class="odd">
<td>60%</td>
<td align="right">0.223</td>
<td align="right">16.576</td>
<td align="right">0.373</td>
<td align="right">0.281</td>
<td align="right">0.197</td>
<td align="right">0.205</td>
<td align="right">0.199</td>
</tr>
<tr class="even">
<td>70%</td>
<td align="right">0.511</td>
<td align="right">16.718</td>
<td align="right">0.769</td>
<td align="right">0.642</td>
<td align="right">0.506</td>
<td align="right">0.453</td>
<td align="right">0.413</td>
</tr>
<tr class="odd">
<td>80%</td>
<td align="right">0.916</td>
<td align="right">16.861</td>
<td align="right">1.319</td>
<td align="right">1.088</td>
<td align="right">0.905</td>
<td align="right">0.873</td>
<td align="right">0.845</td>
</tr>
<tr class="even">
<td>90%</td>
<td align="right">1.609</td>
<td align="right">17.115</td>
<td align="right">2.166</td>
<td align="right">1.907</td>
<td align="right">1.490</td>
<td align="right">1.607</td>
<td align="right">1.373</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">2.303</td>
<td align="right">17.290</td>
<td align="right">3.239</td>
<td align="right">2.625</td>
<td align="right">2.072</td>
<td align="right">2.269</td>
<td align="right">1.978</td>
</tr>
</tbody>
</table>
<p>It seems that set <span class="math inline">\(\sigma = 4\)</span> may be a reasonable choice, let’s check it.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="co"># q: quantiles of Laplace</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="co"># Qrw[,4]: quantiles of the chain with sigma is 4</span></a>
<a class="sourceLine" id="cb102-3" title="3">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb102-4" title="4">    <span class="kw">qqplot</span>(q, Qrw[,<span class="dv">4</span>], <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb102-5" title="5">        <span class="dt">xlab=</span><span class="st">&quot;standard Laplace Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</a>
<a class="sourceLine" id="cb102-6" title="6">    <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb102-7" title="7">    <span class="kw">hist</span>(rw4<span class="op">$</span>x[<span class="dv">501</span><span class="op">:</span>N], <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb102-8" title="8">    <span class="kw">lines</span>(q, <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(q)),<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmkJBmtrZmtv+QOgCQkGaQtpCQ2/+2ZgC2Zjq225C2/7a2///bkDrbtmbb25Db////AAD/tmb/25D//7b//9v///8cydsWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALLUlEQVR4nO2djXarNhZGlZsm7tidOp142ksnwYnf/yEHSfzagk/iHLBMv71WshIbg9gWkpCOhLmQScy9E5A7FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAnSCvg77S2HMy8cdU5MhnaDTy8d593o5vd4xNRnSCvo6HC+lqX5+/LxnerJjIOhUySkoaEDvEnv9Orx8fB14iQ3oF9Lm6f37jX6GKFfzJszz88M2J7QFhV/ehqDqGnv5OO21dtd/dROCyqf3whbSU4aqhmTVErB/jNR1QQ9mEzno+61qSFfN6Klqvnh6v/hq7iEFzUrDoB1kBU00FK1D+3tCY1jQ8/PK93xd9dB/9XPWrpo/mhx0Gr8Zsw4t1SZXgsIJalldUIuioLoMKnwZE8TnoIttUyblIHuFbUCQrcVM1Vac2LjRUm2ZKGgLOSiGJn99v1HQPIK7q/xQ0NTuNiDIFT81ou6OrQpSg4Jm7M76oaCJ3bn7jCUFnXejbbf+YT9FZdC+LYa0yyB/o7GEoIiSU0uQGre7M74IWiQHlcY17VfIQRVfv/k2tGxUY11BF9uLvrYg2ahGQJAvo5cqg07VvdEagk7d1SzqUgx48JX8YoV0Yfbr5iAZQUFm0VrsvPtlFUE6jOSgRav577fxLhpNQdVxFqnmFxc0haagk8aY860H72dpQTEdeNIyaHI4I3l3LesIuk5GqAtYLGi8r3XG7lruIqhFUZDOqPyGBbngIDE3Hmo/CwmCFctQ0JxE9C4xeLOaeHPo/l9UUNG0asux5q2ioBjG++pHxsW6MdXktFXfBrrm22GoixvRCyas9/cKgnBBZa7/awY0ZqStQPc9vXpl7BZbU1BzAU02h1BBpSnoghytnIPsgPLr1J1x2u78f2139NwyqJj6ytph4DXKINtQLG1YgihQ+roMaocMZwkqXbSNi5YI0+T60Q1UBR0v53/9dD/zuU5CG/eSnjZ78v7EBX14ioLsBW27PLQFjbwB+TpMhgnMSM+nmdNS7PZg7/dOe91LTCJIvQtYKshOQhgP25iRoF4zUSBIrwtYLEgDM/ynC71LPM4SXcDZCTL9uJfZOUgvPUJB+gOHMkE66Ocg4WSfoaBe1MJmBAnniw3LoF5kWZqgRYbClQRpjqz2wqO3k4M0R1a7Wn47goTzxW4usbHjYCRzaMOd9jq1mGxS76CQ7ge3pgtSmUObcztoUInNuRfTmEO7cUHyObSKgvwAgZ2UOdG2TxlFEArSmUOrJ6geICgm2x1powjCMkhlDq2aoLLpfCkmxhLS+oDNYArLg1fz7RflpmWObTs+ihCoVodX2KMLak+9ePkbTairt0M5SCxIOxzHqAiavtVIGUUQC9IOxxEJ6pWFkw2zlFEEeyMmKIOiwnFSJhl/GpVC+vyrqJ+qZ2Q4zXBWOwiRNMm4EjTH0E01Lwvx6F1SwyksyYIiKvi0ScZCQXWZKF1eSU9QRDjO+CTj0GGlgnTQExTRYZY2yTgzQdeTxBZpByVNMs5P0KAzZpmGYsok4/wESY+jvNhKZoKMWFDMYivx6clN0M16JjOqebzYSscqhbRilr6uw2Y2FMFiKxPJCPRJiwVpZmkFQRGLrcSnxyJvKKZkabA7BUERi63Ep8ciFSTK0je7u1kyaF4tBhZbSeoC1spBOln6ZkGcZRqKKV3ASmWQUpa+quSXEZTWBaxSi6EsHb07uSB/LzaZndMCyfNqB4kFneqOsKkAs7VzkAZNLSYV1HXgTQW2JwWS5yQosOxd2nGW6AIWCdJdP+i2FZQqqNdcVRt6vmsOGjbtNQRFjbJEJKz969MlL93QEpfYVgW560zYKa1UBmUpyFcchawh5HcXWFjy8QV9v7VDBOIE3VTy6YI0Kw2HWJDm5BGxIDUWyEEas302KageqNO4WQ342YAgnct+w4J0yFaQoaDB0W467RUERc2bj9rd/QXdHlYuaGLydeLuQn42IEhv/aAsBXk/shyktQJV8BkRjy9IGnzX7i78kIgtCNqpFNKhvo5LNoLSDfUuMZ0lukx4+ejHFxRVSEeE3eYpqPFjktfvSCqko8Juwwu0P76giEI6Luw2/BiWZQRFj80rCIpa5C0i7DbYClpIUPzYfHfvMT8HYaLCblcUlDCyuo6gqLDbFQXFj80bDUExN6tjYbe9w2eZg1QEKS3ytm4ZFDk2b8xsRb1COnaRt6kGwW3UwvVxVIkcmzc6gmIXectIEMSP9KoIil/kDQgKHz8nQUlp6TaOXuQN5aDg8RcWNBVIfuNnpqDoRd5yFHR9NEj8rnRTNvqkrDtdYnL0BWVVBslpEn7e7d3aqcIo19FH8t7pZlVOnXDXPrSDz8KG4lgtf6+bVTl1wl2opJvKL1vQ6FleKsYTcasxXlzHHsRv6IImfaercJ3ApukR+KVOTJiVmfiJohF0bEJLH0hQVA6a+ImiJ8gXP7L4oMuagiJuVrUEuZLHhSfKBzdWFBSxMp2WoPLp3T8OT77mypqC4lKjIcg2gSo/5508gmGjgnSTREFojxQE9khB/xgoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQQF2QG8tbbJQqGTt/QO9RKgp8vz29Ty6Mvy42JEz2YAVtQfXQyIJjwSn4gSFRapYpg0qNJ1wqoDCDaRlBKuvRK1D++Oug+JRENRaMJUijsHEfsqG+JQSV2ZTRfqkW0Wj6AoKyyT9N8SwK6VEUVD/7fHLhuvVwqfF5R1RUq+cg6XMVVPEBMlldYi6ULx9srIpsPre2oMKHW2TSDvKPrM+vmt8SFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIAXVI5GZIxEGzYvjz8qKWb55TKnUfwRnKCJk1lQkF/OM7NwkBvuKKiOzhUu6bQ0VSY/2mh0+xBj45Yb/zr8fjD1g5DM0x/WRPPOb3/YoMj25UtfUL3N+df/7FzAiRNUv+ijYl4vbRSapX3Qo1t979h8Yt3Txxi7MJdP2muz5LiNla9+bCxvacuI7p1m+ZPSXAtqtqlkH91aX3af7Zoy/tP7egsvpg2MK3/8bAXJ1r9agvYScw9gs9ndfbPVHz7rn57eb97xL7uPN4LabfzpuwfXH4cfvFwt4dRevG7lGS+oeQpcRgzKoNLUX7395c+jPo3uncHLgzLIbeP9Nec8eLH5VP1fSNDy55uMac+8Kh5+/LnrBBWticE7RVhQs42/cOpzHr7oq3XTFEvBS6zIrl1m3EV0qL/l8y6Qg4bvhHNQu01fUPfiIAfVdIW0ux7dMTOs0Yy79Kv0uRMve5dYPW/n6X34Tvuy+3gjqN3Gl0H+nHsfbMqg/vkXbprAy/+qTzSlm3iFOX2M/7b3dRYx+67KtRJsdTV8p33Zfbyfg9w25517+9godi+6z9gpE85rU8C7+vD7zbhI3ZeP6q8sc5DxDZ2XD9u8eT/1C8ymwTN45zJsB/lCZd9uc979e1c3p47ti8N2UJdLynahUbta2++ZlkG6zMkD/82ubu+Rg6CsoSBAdtd8blAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwP8BAMKaexIrXnwAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="hw102019-12-6" class="section level2">
<h2>HW10:2019-12-6</h2>
<div id="question-1-6" class="section level3">
<h3>Question 1</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">x &lt;-<span class="st"> </span><span class="fl">3.14</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="co"># the formula below is not true in computer arithmetic</span></a>
<a class="sourceLine" id="cb103-3" title="3"><span class="kw">exp</span>(<span class="kw">log</span>(x)) <span class="op">==</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(x))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># the all.equal test if two objects are nearly equal</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="kw">all.equal</span>(<span class="kw">exp</span>(<span class="kw">log</span>(x)),<span class="kw">log</span>(<span class="kw">exp</span>(x)))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="question-2-6" class="section level3">
<h3>Question 2</h3>
<p>First, we calculate the root in 11.5</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="co"># the integration</span></a>
<a class="sourceLine" id="cb107-2" title="2">integ =<span class="st"> </span><span class="cf">function</span>(k,u){</a>
<a class="sourceLine" id="cb107-3" title="3">  <span class="kw">return</span>((<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k))<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb107-4" title="4">}</a>
<a class="sourceLine" id="cb107-5" title="5"><span class="co">#calculate c_k</span></a>
<a class="sourceLine" id="cb107-6" title="6">c_k &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb107-7" title="7">  <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb107-8" title="8">}</a>
<a class="sourceLine" id="cb107-9" title="9"><span class="co"># the equation in log </span></a>
<a class="sourceLine" id="cb107-10" title="10">equation &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb107-11" title="11">   (<span class="kw">log</span>(k) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(k<span class="dv">-1</span>))<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb107-12" title="12"><span class="st">   </span>(<span class="dv">2</span><span class="op">*</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-13" title="13"><span class="st">   </span><span class="kw">log</span>(<span class="kw">integrate</span>(integ,<span class="dv">0</span>,<span class="kw">c_k</span>(k<span class="dv">-1</span>,a),<span class="dt">k =</span> k<span class="dv">-1</span>)<span class="op">$</span>value) <span class="op">-</span></a>
<a class="sourceLine" id="cb107-14" title="14"><span class="st">   </span><span class="kw">log</span>(<span class="kw">integrate</span>(integ,<span class="dv">0</span>, <span class="kw">c_k</span>(k,a),<span class="dt">k =</span> k)<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb107-15" title="15">}</a>
<a class="sourceLine" id="cb107-16" title="16">root.equation &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>),<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb107-17" title="17">                           <span class="kw">uniroot</span>(equation,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">k=</span>k)<span class="op">$</span>root})</a></code></pre></div>
<p>Now we calculate the result in 11.4</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">equation_<span class="dv">11</span>_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb108-2" title="2">  <span class="kw">pt</span>(<span class="kw">c_k</span>(k<span class="dv">-1</span>,a),<span class="dt">df =</span> k<span class="dv">-1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">c_k</span>(k,a),<span class="dt">df =</span> k)</a>
<a class="sourceLine" id="cb108-3" title="3">}</a>
<a class="sourceLine" id="cb108-4" title="4">root.curve &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>),<span class="cf">function</span>(k){<span class="kw">uniroot</span>(equation_<span class="dv">11</span>_<span class="dv">4</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">k=</span>k)<span class="op">$</span>root})</a></code></pre></div>
<p>Now, let’s compare the two results.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">result &lt;-<span class="st"> </span><span class="kw">cbind</span>(root.equation,root.curve)</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;root in 11.5&quot;</span>,<span class="st">&quot;root in 11.4&quot;</span>)</a>
<a class="sourceLine" id="cb109-3" title="3"><span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb109-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(result)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">root in 11.5</th>
<th align="right">root in 11.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td align="right">1.492088</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td>5</td>
<td align="right">1.533559</td>
<td align="right">1.533556</td>
</tr>
<tr class="odd">
<td>6</td>
<td align="right">1.562747</td>
<td align="right">1.562744</td>
</tr>
<tr class="even">
<td>7</td>
<td align="right">1.584435</td>
<td align="right">1.584430</td>
</tr>
<tr class="odd">
<td>8</td>
<td align="right">1.601193</td>
<td align="right">1.601185</td>
</tr>
<tr class="even">
<td>9</td>
<td align="right">1.614533</td>
<td align="right">1.614521</td>
</tr>
<tr class="odd">
<td>10</td>
<td align="right">1.625405</td>
<td align="right">1.625390</td>
</tr>
<tr class="even">
<td>11</td>
<td align="right">1.634436</td>
<td align="right">1.634419</td>
</tr>
<tr class="odd">
<td>12</td>
<td align="right">1.641997</td>
<td align="right">1.642038</td>
</tr>
<tr class="even">
<td>13</td>
<td align="right">1.648515</td>
<td align="right">1.648554</td>
</tr>
<tr class="odd">
<td>14</td>
<td align="right">1.654154</td>
<td align="right">1.654190</td>
</tr>
<tr class="even">
<td>15</td>
<td align="right">1.659080</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td>16</td>
<td align="right">1.663420</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td>17</td>
<td align="right">1.667273</td>
<td align="right">1.667304</td>
</tr>
<tr class="odd">
<td>18</td>
<td align="right">1.670716</td>
<td align="right">1.670745</td>
</tr>
<tr class="even">
<td>19</td>
<td align="right">1.673812</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td>20</td>
<td align="right">1.676611</td>
<td align="right">1.676637</td>
</tr>
<tr class="even">
<td>21</td>
<td align="right">1.679153</td>
<td align="right">1.679178</td>
</tr>
<tr class="odd">
<td>22</td>
<td align="right">1.681471</td>
<td align="right">1.681496</td>
</tr>
<tr class="even">
<td>23</td>
<td align="right">1.683594</td>
<td align="right">1.683620</td>
</tr>
<tr class="odd">
<td>24</td>
<td align="right">1.685546</td>
<td align="right">1.685572</td>
</tr>
<tr class="even">
<td>25</td>
<td align="right">1.687347</td>
<td align="right">1.687373</td>
</tr>
<tr class="odd">
<td>100</td>
<td align="right">1.720599</td>
<td align="right">1.720608</td>
</tr>
<tr class="even">
<td>500</td>
<td align="right">1.729745</td>
<td align="right">1.729756</td>
</tr>
<tr class="odd">
<td>1000</td>
<td align="right">1.730897</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
</div>
<div id="question-3-2" class="section level3">
<h3>Question 3</h3>
<p>the initial parameter and observed data</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">set.seed</span>(<span class="dv">125</span>)</a>
<a class="sourceLine" id="cb110-2" title="2">n_a. &lt;-<span class="st"> </span><span class="dv">28</span></a>
<a class="sourceLine" id="cb110-3" title="3">n_b. &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb110-4" title="4">n_ab &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb110-5" title="5">n_oo &lt;-<span class="st"> </span><span class="dv">41</span></a>
<a class="sourceLine" id="cb110-6" title="6">p0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb110-7" title="7">q0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">-</span>p0)</a></code></pre></div>
<p>In the E step, we calculate the expectation of log-likelihood function.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">likelihood_e &lt;-<span class="st"> </span><span class="cf">function</span>(prob,p0,q0){</a>
<a class="sourceLine" id="cb111-2" title="2">  r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0 </a>
<a class="sourceLine" id="cb111-3" title="3">  p &lt;-<span class="st"> </span>prob[<span class="dv">1</span>]; q &lt;-<span class="st"> </span>prob[<span class="dv">2</span>] ; r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb111-4" title="4">  <span class="op">-</span><span class="st"> </span>n_a. <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(p)<span class="op">*</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0)) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0<span class="op">/</span>(p0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p0<span class="op">*</span>r0))) <span class="op">-</span></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="st">    </span>n_b. <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(q)<span class="op">*</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0)) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0<span class="op">/</span>(q0<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q0<span class="op">*</span>r0))) <span class="op">-</span></a>
<a class="sourceLine" id="cb111-6" title="6"><span class="st">    </span>n_ab <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>n_oo <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(r<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb111-7" title="7">}</a></code></pre></div>
<p>In the M step, we use function <code>optim()</code> to maximize and renew the parameters.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">iter &lt;-<span class="st"> </span><span class="dv">0</span>;E1 &lt;-<span class="st"> </span><span class="dv">0</span>;E2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="cf">while</span>(iter <span class="op">&lt;</span><span class="st"> </span><span class="dv">200</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(E1<span class="op">-</span>E2)<span class="op">&gt;</span><span class="st"> </span><span class="fl">1e-6</span>){</a>
<a class="sourceLine" id="cb112-3" title="3">  output &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>),likelihood_e,<span class="dt">p0 =</span> p0,<span class="dt">q0 =</span> q0)</a>
<a class="sourceLine" id="cb112-4" title="4">  E1 &lt;-<span class="st"> </span>E2;E2 &lt;-<span class="st"> </span>output<span class="op">$</span>value</a>
<a class="sourceLine" id="cb112-5" title="5">  p0 &lt;-<span class="st"> </span>output<span class="op">$</span>par[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb112-6" title="6">  q0 &lt;-<span class="st"> </span>output<span class="op">$</span>par[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb112-7" title="7">  iter &lt;-<span class="st"> </span>iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb112-8" title="8">}</a>
<a class="sourceLine" id="cb112-9" title="9">estimate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(p0,q0,iter)</a>
<a class="sourceLine" id="cb112-10" title="10"><span class="kw">colnames</span>(estimate) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;q&quot;</span>,<span class="st">&quot;iteration times&quot;</span>)</a>
<a class="sourceLine" id="cb112-11" title="11">knitr<span class="op">::</span><span class="kw">kable</span>(estimate)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">p</th>
<th align="right">q</th>
<th align="right">iteration times</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2540916</td>
<td align="right">0.2417525</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>Because the observed data is not really reasonable, so the estimate cannot fit the observed data well.</p>
</div>
</div>
<div id="hw112019-12-13" class="section level2">
<h2>HW11:2019-12-13</h2>
<div id="p204-345" class="section level3">
<h3>P204 3,4,5</h3>
<ul>
<li><strong>Use both for loops and <code>lapply()</code> to fit linear models to the <code>mtcars</code> using the formulas stored in this lists:</strong></li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb113-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb113-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb113-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span>wt,</a>
<a class="sourceLine" id="cb113-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb113-6" title="6">)</a></code></pre></div>
<p>Use for loops:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">models.loop &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</a>
<a class="sourceLine" id="cb114-3" title="3">  models.loop &lt;-<span class="st"> </span><span class="kw">c</span>(models.loop,<span class="kw">list</span>(<span class="kw">lm</span>(formulas[[i]],<span class="dt">data =</span> mtcars)))</a>
<a class="sourceLine" id="cb114-4" title="4">}</a></code></pre></div>
<p>use lapply:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">models &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas,lm,<span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb115-2" title="2">models</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<ul>
<li><strong>Fit the model <code>mpg ~ disp</code> to each of the bootstrap replicates of <code>mtcars</code> in the list below by using a for loop and <code>lapply()</code>. Can you do it without an anonymous function?</strong></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb117-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb117-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb117-4" title="4">})</a></code></pre></div>
<p>Use for loop</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">models2.loop &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb118-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb118-3" title="3">  models2.loop &lt;-<span class="st"> </span><span class="kw">c</span>(models2.loop,<span class="kw">list</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,<span class="dt">data =</span> bootstraps[[i]])))</a>
<a class="sourceLine" id="cb118-4" title="4">}</a></code></pre></div>
<p>Use <code>lapply()</code></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">models2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula =</span> mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb119-2" title="2">models2</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.65849     -0.04518  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76113     -0.04258  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.87521     -0.03583  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.27895     -0.03907  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.74218     -0.05038  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.97553     -0.03672  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.6608      -0.0424  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.77315     -0.03754  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.55734     -0.03557  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.24600     -0.04071</code></pre>
<ul>
<li><strong>For each model in the previous two exercises, extract R^2 using the function below.</strong></li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary.lm</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb121-2" title="2"><span class="co"># The r.squared from four different models</span></a>
<a class="sourceLine" id="cb121-3" title="3">rsq1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(models.loop,rsq)),<span class="kw">unlist</span>(<span class="kw">sapply</span>(models,rsq))),</a>
<a class="sourceLine" id="cb121-4" title="4">               <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">dimnames =</span> <span class="kw">c</span>(<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;loop&quot;</span>,<span class="st">&quot;apply&quot;</span>)),</a>
<a class="sourceLine" id="cb121-5" title="5">                                                   <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;mpg ~ disp&quot;</span>,</a>
<a class="sourceLine" id="cb121-6" title="6">                                                          <span class="st">&quot;mpg ~ I(1 / disp)&quot;</span>,</a>
<a class="sourceLine" id="cb121-7" title="7">                                                          <span class="st">&quot;mpg ~ disp +wt&quot;</span>,</a>
<a class="sourceLine" id="cb121-8" title="8">                                                          <span class="st">&quot;mpg ~ I(1 / disp) + wt&quot;</span>))))</a>
<a class="sourceLine" id="cb121-9" title="9">knitr<span class="op">::</span><span class="kw">kable</span>(rsq1)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg ~ disp</th>
<th align="right">mpg ~ I(1 / disp)</th>
<th align="right">mpg ~ disp +wt</th>
<th align="right">mpg ~ I(1 / disp) + wt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>loop</td>
<td align="right">0.7183433</td>
<td align="right">0.8596865</td>
<td align="right">0.7809306</td>
<td align="right">0.8838038</td>
</tr>
<tr class="even">
<td>apply</td>
<td align="right">0.7183433</td>
<td align="right">0.8596865</td>
<td align="right">0.7809306</td>
<td align="right">0.8838038</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co"># The r.squared from bootstrap replicates</span></a>
<a class="sourceLine" id="cb122-2" title="2">rsq2&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">round</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(models2.loop,rsq)),<span class="dv">3</span>),<span class="kw">round</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(models2,rsq)),<span class="dv">3</span>)),</a>
<a class="sourceLine" id="cb122-3" title="3">               <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">dimnames =</span> <span class="kw">c</span>(<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;loop&quot;</span>,<span class="st">&quot;apply&quot;</span>)),</a>
<a class="sourceLine" id="cb122-4" title="4">                                                   <span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb122-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(rsq2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>loop</td>
<td align="right">0.745</td>
<td align="right">0.792</td>
<td align="right">0.739</td>
<td align="right">0.727</td>
<td align="right">0.791</td>
<td align="right">0.702</td>
<td align="right">0.729</td>
<td align="right">0.77</td>
<td align="right">0.667</td>
<td align="right">0.732</td>
</tr>
<tr class="even">
<td>apply</td>
<td align="right">0.745</td>
<td align="right">0.792</td>
<td align="right">0.739</td>
<td align="right">0.727</td>
<td align="right">0.791</td>
<td align="right">0.702</td>
<td align="right">0.729</td>
<td align="right">0.77</td>
<td align="right">0.667</td>
<td align="right">0.732</td>
</tr>
</tbody>
</table>
</div>
<div id="p214-37" class="section level3">
<h3>P214 3,7</h3>
<ul>
<li><strong>The following code simulates the performance of a t-test for non-normal data. Use <code>sapply()</code> and an annoymous function to extract the p-value from every trial. Extra challenge: get rid of the anonymous function by using<code>[[</code> directly.</strong></li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb123-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb123-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb123-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb123-5" title="5">)</a></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">round</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i){trials[[i]]<span class="op">$</span>p.value}),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.689 0.182 0.630 0.357 0.844 0.688 0.326 0.845 0.178 0.221 0.404
##  [12] 0.484 0.789 0.760 0.408 0.879 0.396 0.923 0.029 0.901 0.980 0.830
##  [23] 0.132 0.156 0.957 0.880 0.027 0.883 0.508 0.566 0.474 0.979 0.185
##  [34] 0.077 0.700 0.769 0.701 0.071 0.741 0.548 0.559 0.033 0.195 0.680
##  [45] 0.092 0.986 0.691 0.058 0.755 0.159 0.842 0.758 0.381 0.528 0.257
##  [56] 0.387 0.578 0.055 0.365 0.114 0.992 0.216 0.531 0.526 0.366 0.078
##  [67] 0.636 0.650 0.685 0.085 0.417 0.830 0.004 0.179 0.451 0.698 0.152
##  [78] 0.901 0.597 0.536 0.325 0.857 0.811 0.951 0.173 0.653 0.435 0.635
##  [89] 0.300 0.477 0.358 0.779 0.090 0.815 0.835 0.702 0.862 0.354 0.508
## [100] 0.502</code></pre>
<p>Use the<code>[[</code> to get rid of anonymous function.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">round</span>(<span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;p.value&quot;</span>),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.689 0.182 0.630 0.357 0.844 0.688 0.326 0.845 0.178 0.221 0.404
##  [12] 0.484 0.789 0.760 0.408 0.879 0.396 0.923 0.029 0.901 0.980 0.830
##  [23] 0.132 0.156 0.957 0.880 0.027 0.883 0.508 0.566 0.474 0.979 0.185
##  [34] 0.077 0.700 0.769 0.701 0.071 0.741 0.548 0.559 0.033 0.195 0.680
##  [45] 0.092 0.986 0.691 0.058 0.755 0.159 0.842 0.758 0.381 0.528 0.257
##  [56] 0.387 0.578 0.055 0.365 0.114 0.992 0.216 0.531 0.526 0.366 0.078
##  [67] 0.636 0.650 0.685 0.085 0.417 0.830 0.004 0.179 0.451 0.698 0.152
##  [78] 0.901 0.597 0.536 0.325 0.857 0.811 0.951 0.173 0.653 0.435 0.635
##  [89] 0.300 0.477 0.358 0.779 0.090 0.815 0.835 0.702 0.862 0.354 0.508
## [100] 0.502</code></pre>
<ul>
<li><strong>Implement <code>mcsapply()</code>, a multicore version of <code>sapply()</code>. Can you implement <code>mcvapply</code>, a parallel version of vapply()? Why or why not?</strong></li>
</ul>
<p>Let’s see what <code>sapply</code> is:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">sapply</a></code></pre></div>
<pre><code>## function (X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE) 
## {
##     FUN &lt;- match.fun(FUN)
##     answer &lt;- lapply(X = X, FUN = FUN, ...)
##     if (USE.NAMES &amp;&amp; is.character(X) &amp;&amp; is.null(names(answer))) 
##         names(answer) &lt;- X
##     if (!isFALSE(simplify) &amp;&amp; length(answer)) 
##         simplify2array(answer, higher = (simplify == &quot;array&quot;))
##     else answer
## }
## &lt;bytecode: 0x000000001592fd08&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>We can see that <code>sapply</code> actually simplify the results from <code>lapply</code>. We can implement <code>mcsapply</code> by replacing some parts of <code>sapply</code>. Since windows OS don’t support mc.cores &gt; 1, we use package <code>parallelsugar</code></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">library</span>(parallelsugar)</a>
<a class="sourceLine" id="cb130-2" title="2">mcsapply &lt;-<span class="st"> </span><span class="cf">function</span> (X, FUN, ..., mc.cores,<span class="dt">simplify =</span> <span class="ot">TRUE</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb130-3" title="3">  FUN &lt;-<span class="st"> </span><span class="kw">match.fun</span>(FUN)</a>
<a class="sourceLine" id="cb130-4" title="4">  answer &lt;-<span class="st"> </span><span class="kw">mclapply</span>(<span class="dt">X =</span> X, <span class="dt">FUN =</span> FUN, ...,<span class="dt">mc.cores =</span> mc.cores)</a>
<a class="sourceLine" id="cb130-5" title="5">  <span class="cf">if</span> (USE.NAMES <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.character</span>(X) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.null</span>(<span class="kw">names</span>(answer))) </a>
<a class="sourceLine" id="cb130-6" title="6">    <span class="kw">names</span>(answer) &lt;-<span class="st"> </span>X</a>
<a class="sourceLine" id="cb130-7" title="7">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">isFALSE</span>(simplify) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">length</span>(answer)) </a>
<a class="sourceLine" id="cb130-8" title="8">    <span class="kw">simplify2array</span>(answer, <span class="dt">higher =</span> (simplify <span class="op">==</span><span class="st"> &quot;array&quot;</span>))</a>
<a class="sourceLine" id="cb130-9" title="9">  <span class="cf">else</span> answer</a>
<a class="sourceLine" id="cb130-10" title="10">}</a></code></pre></div>
<p>let’s implement a example:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>, <span class="cf">function</span>(i) <span class="kw">rnorm</span>(<span class="fl">5e5</span>)))</a></code></pre></div>
<pre><code>##  用户  系统  流逝 
## 38.78  1.06 40.03</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>, <span class="cf">function</span>(i) <span class="kw">rnorm</span>(<span class="fl">5e5</span>), <span class="dt">mc.cores =</span> <span class="dv">4</span>))</a></code></pre></div>
<pre><code>##  用户  系统  流逝 
##  7.59  7.19 37.21</code></pre>
<p>The using time decreases, but the system need more to time allocate the task to different cores.</p>
<p><strong>We can’t implement a parallel version of <code>vapply</code>, because in the <code>vapply</code>, we need to make sure if the return value satisfies the pre-specified type, this process cannot be implemented parallel.</strong></p>
</div>
</div>
<div id="hw122019-12-20" class="section level2">
<h2>HW12:2019-12-20</h2>
<div id="rewrite-a-rcpp-function" class="section level4">
<h4>Rewrite a Rcpp function</h4>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(x0,sigma,N) {</a>
<a class="sourceLine" id="cb135-2" title="2">  <span class="co">#x0: the initial point</span></a>
<a class="sourceLine" id="cb135-3" title="3">  <span class="co">#sigma: the standard deviation in the normal distribution</span></a>
<a class="sourceLine" id="cb135-4" title="4">  <span class="co">#N: the length of the chain</span></a>
<a class="sourceLine" id="cb135-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb135-6" title="6">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb135-7" title="7">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb135-8" title="8">  accept &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#count reject</span></a>
<a class="sourceLine" id="cb135-9" title="9">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb135-10" title="10">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</a>
<a class="sourceLine" id="cb135-11" title="11">    <span class="cf">if</span>(u[i] <span class="op">&lt;</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))){</a>
<a class="sourceLine" id="cb135-12" title="12">       x[i] &lt;-<span class="st"> </span>y;accept &lt;-<span class="st"> </span>accept <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb135-13" title="13">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb135-14" title="14">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb135-15" title="15">    }</a>
<a class="sourceLine" id="cb135-16" title="16">  }</a>
<a class="sourceLine" id="cb135-17" title="17">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x,<span class="dt">accept =</span> accept))</a>
<a class="sourceLine" id="cb135-18" title="18">}</a></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="kw">cppFunction</span>(<span class="st">&#39;List rw_Metropolis_c(double x0, double sigma, int N) {</span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="st">  NumericVector x(N);</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="st">  as&lt;DoubleVector&gt;(x)[0] = x0;</span></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="st">  NumericVector u(N);</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="st">  u = as&lt;DoubleVector&gt;(runif(N));</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="st">  List out(2);</span></a>
<a class="sourceLine" id="cb136-8" title="8"><span class="st">  int accept = 1;</span></a>
<a class="sourceLine" id="cb136-9" title="9"><span class="st">  for(int i=1;i&lt;N;i++){</span></a>
<a class="sourceLine" id="cb136-10" title="10"><span class="st">    double y = as&lt;double&gt;(rnorm(1,x[i-1],sigma));</span></a>
<a class="sourceLine" id="cb136-11" title="11"><span class="st">    if(u[i] &lt;= exp(abs(x[i-1])-abs(y))){</span></a>
<a class="sourceLine" id="cb136-12" title="12"><span class="st">        x[i] = y;accept = accept + 1;</span></a>
<a class="sourceLine" id="cb136-13" title="13"><span class="st">    }</span></a>
<a class="sourceLine" id="cb136-14" title="14"><span class="st">    else{</span></a>
<a class="sourceLine" id="cb136-15" title="15"><span class="st">        x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb136-16" title="16"><span class="st">    }</span></a>
<a class="sourceLine" id="cb136-17" title="17"><span class="st">  }  </span></a>
<a class="sourceLine" id="cb136-18" title="18"><span class="st">  out[0] = x;</span></a>
<a class="sourceLine" id="cb136-19" title="19"><span class="st">  out[1] = accept;</span></a>
<a class="sourceLine" id="cb136-20" title="20"><span class="st">  return(out);</span></a>
<a class="sourceLine" id="cb136-21" title="21"><span class="st">}&#39;</span>)</a></code></pre></div>
</div>
<div id="compare-the-generated-random-numbers-by-the-two-functions-using-qqplot" class="section level4">
<h4>Compare the generated random numbers by the two functions using qqplot</h4>
<p>First we have a look at the two chains</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">N =<span class="st"> </span><span class="dv">5000</span>; sigma =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">8</span>);x0 =<span class="st"> </span><span class="dv">10</span>;</a>
<a class="sourceLine" id="cb137-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb137-3" title="3">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain&quot;</span>,i),<span class="kw">rw.Metropolis</span>(x0,sigma[i],N))  </a>
<a class="sourceLine" id="cb137-4" title="4">  <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain_c&quot;</span>,i),<span class="kw">rw_Metropolis_c</span>(x0,sigma[i],N))  </a>
<a class="sourceLine" id="cb137-5" title="5">}</a>
<a class="sourceLine" id="cb137-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb137-7" title="7">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb137-8" title="8">  <span class="kw">plot</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain&quot;</span>,i))<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;from R&quot;</span>,</a>
<a class="sourceLine" id="cb137-9" title="9">       <span class="dt">main =</span> <span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])))</a>
<a class="sourceLine" id="cb137-10" title="10">  <span class="kw">plot</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain_c&quot;</span>,i))[[<span class="dv">1</span>]],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;from Rcpp&quot;</span>,</a>
<a class="sourceLine" id="cb137-11" title="11">       <span class="dt">main =</span> <span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])))</a>
<a class="sourceLine" id="cb137-12" title="12">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we compare their acceptance rate:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb138-3" title="3">  a &lt;-<span class="st"> </span><span class="kw">cbind</span>(a,<span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain&quot;</span>,i))<span class="op">$</span>accept<span class="op">/</span>N</a>
<a class="sourceLine" id="cb138-4" title="4">                       ,<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain_c&quot;</span>,i))[[<span class="dv">2</span>]]<span class="op">/</span>N),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb138-5" title="5">  <span class="kw">colnames</span>(a)[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[i])</a>
<a class="sourceLine" id="cb138-6" title="6">}</a>
<a class="sourceLine" id="cb138-7" title="7">a &lt;-<span class="st"> </span>a[<span class="dv">2</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb138-8" title="8"><span class="kw">rownames</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;from R&quot;</span>,<span class="st">&quot;from Rcpp&quot;</span>)</a>
<a class="sourceLine" id="cb138-9" title="9">knitr<span class="op">::</span><span class="kw">kable</span>(a)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma = 0.05</th>
<th align="right">sigma = 0.5</th>
<th align="right">sigma = 2</th>
<th align="right">sigma = 8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>from R</td>
<td align="right">0.97</td>
<td align="right">0.84</td>
<td align="right">0.52</td>
<td align="right">0.18</td>
</tr>
<tr class="even">
<td>from Rcpp</td>
<td align="right">0.99</td>
<td align="right">0.87</td>
<td align="right">0.58</td>
<td align="right">0.20</td>
</tr>
</tbody>
</table>
<p>Now let’s see the qqplot.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb139-2" title="2">  <span class="kw">qqplot</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain&quot;</span>,i))<span class="op">$</span>x,</a>
<a class="sourceLine" id="cb139-3" title="3">         <span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;chain_c&quot;</span>,i))[[<span class="dv">1</span>]],</a>
<a class="sourceLine" id="cb139-4" title="4">         <span class="dt">xlab =</span> <span class="st">&quot;from R&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;from Rcpp&quot;</span>,</a>
<a class="sourceLine" id="cb139-5" title="5">         <span class="dt">main =</span> <span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(sigma[i])))</a>
<a class="sourceLine" id="cb139-6" title="6">  f &lt;-<span class="st"> </span><span class="cf">function</span>(x) x</a>
<a class="sourceLine" id="cb139-7" title="7">  <span class="kw">curve</span>(f, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>,<span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb139-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Frow the figure, we conclude that if the generated chains converge, they have similar quantiles.</p>
<p>we choose the <code>median</code> to compare consuming time of two chains</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb140-2" title="2">b &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb140-3" title="3">ts1 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">chain =</span> <span class="kw">rw.Metropolis</span>(x0,sigma[<span class="dv">1</span>],N),</a>
<a class="sourceLine" id="cb140-4" title="4">                     <span class="dt">chain_c =</span> <span class="kw">rw_Metropolis_c</span>(x0,sigma[<span class="dv">1</span>],N))</a>
<a class="sourceLine" id="cb140-5" title="5">ts2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">chain =</span> <span class="kw">rw.Metropolis</span>(x0,sigma[<span class="dv">2</span>],N),</a>
<a class="sourceLine" id="cb140-6" title="6">                     <span class="dt">chain_c =</span> <span class="kw">rw_Metropolis_c</span>(x0,sigma[<span class="dv">2</span>],N))</a>
<a class="sourceLine" id="cb140-7" title="7">ts3 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">chain =</span> <span class="kw">rw.Metropolis</span>(x0,sigma[<span class="dv">3</span>],N),</a>
<a class="sourceLine" id="cb140-8" title="8">                     <span class="dt">chain_c =</span> <span class="kw">rw_Metropolis_c</span>(x0,sigma[<span class="dv">3</span>],N))</a>
<a class="sourceLine" id="cb140-9" title="9">ts4 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">chain =</span> <span class="kw">rw.Metropolis</span>(x0,sigma[<span class="dv">4</span>],N),</a>
<a class="sourceLine" id="cb140-10" title="10">                     <span class="dt">chain_c =</span> <span class="kw">rw_Metropolis_c</span>(x0,sigma[<span class="dv">4</span>],N))</a>
<a class="sourceLine" id="cb140-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)){</a>
<a class="sourceLine" id="cb140-12" title="12">  b &lt;-<span class="st"> </span><span class="kw">cbind</span>(b,<span class="kw">summary</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;ts&quot;</span>,i)))<span class="op">$</span>median)</a>
<a class="sourceLine" id="cb140-13" title="13">  <span class="kw">colnames</span>(b)[i<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[i])</a>
<a class="sourceLine" id="cb140-14" title="14">}</a>
<a class="sourceLine" id="cb140-15" title="15">b &lt;-<span class="st"> </span>b[<span class="dv">2</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb140-16" title="16"><span class="kw">rownames</span>(b) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;from R&quot;</span>,<span class="st">&quot;from Rcpp&quot;</span>)</a>
<a class="sourceLine" id="cb140-17" title="17">knitr<span class="op">::</span><span class="kw">kable</span>(b)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma = 0.05</th>
<th align="right">sigma = 0.5</th>
<th align="right">sigma = 2</th>
<th align="right">sigma = 8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>from R</td>
<td align="right">19997.95</td>
<td align="right">18136.3</td>
<td align="right">13151.40</td>
<td align="right">10569.65</td>
</tr>
<tr class="even">
<td>from Rcpp</td>
<td align="right">1003.90</td>
<td align="right">767.6</td>
<td align="right">745.95</td>
<td align="right">685.25</td>
</tr>
</tbody>
</table>
<p><strong>We can conclude that the Rcpp function implement the same work as the R function do, the acceptance rate from two chains is similar, but Rcpp function consume much less time.</strong></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
